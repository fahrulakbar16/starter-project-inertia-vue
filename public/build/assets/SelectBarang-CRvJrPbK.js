import{d as m,y as b,l as A,s as P,e as d,o as u,a as o,E as W,t as k,V as U,bt as q,K as G,G as R,f as V,F as J,i as Q,n as M,r as X,O as Y}from"./app-CJkCV51W.js";const Z=["disabled"],ee={class:"truncate text-left"},te={class:"p-3 border-b border-gray-100 dark:border-gray-600"},oe=["onKeydown"],re={class:"max-h-60 overflow-y-auto py-1","data-simplebar":""},le={class:"font-medium"},ae=["onClick"],ne={key:0,class:"w-2 h-2 rounded-full bg-white"},se={class:"text-gray-900 dark:text-gray-100"},ie={key:1,class:"px-4 py-6 text-center text-gray-500 dark:text-gray-400"},ue={__name:"SelectBarang",props:{items:{type:Array,default:()=>[]},modelValue:{type:[Object,Number,null],default:null},label:{type:String,default:"Pilih Item"},taggable:{type:Boolean,default:!1},labelKey:{type:String,default:"name"},searchKey:{type:String,default:"name"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(y,{emit:j}){const t=y,C=j,a=m(!1),n=m(""),c=m(null),L=m({}),_=b(()=>t.modelValue&&typeof t.modelValue=="object"&&"id"in t.modelValue&&t.modelValue.id!=null&&t.items.find(e=>e.id===t.modelValue.id)||null),z=b(()=>_.value?_.value[t.labelKey]:typeof t.modelValue=="string"&&t.modelValue?t.modelValue:t.label);function D(e){return t.labelKey&&e[t.labelKey]?e.type?.name?`${e[t.labelKey]} - ${e.type.name}`:e[t.labelKey]:e.name||""}const K=b(()=>{const e=(n.value||"").toLowerCase();return t.items.filter(r=>{const l=(r[t.searchKey]||"").toString().toLowerCase(),s=D(r).toLowerCase();return l.includes(e)||s.includes(e)})});function H(){a.value||setTimeout(()=>p(),0),a.value=!a.value}function p(){if(!c.value||!a.value)return;const e=c.value.getBoundingClientRect(),r=310,l=window.innerHeight,s=window.innerWidth;let i=e.bottom+8,f=e.left;const B=e.width,$=Math.min(s-32,400),x=Math.max(B,$);if(i+r>l){const N=e.top,O=l-e.bottom;N>O?i=e.top-r-8:i=l-r-8}i<8&&(i=8),f+x>s&&(f=s-x-16),f<16&&(f=16),L.value={top:`${i}px`,left:`${f}px`,minWidth:`${B}px`,width:`${x}px`,maxWidth:`${$}px`,maxHeight:`${r}px`}}function v(){a.value=!1}function T(e){C("update:modelValue",e),v()}function h(e){return t.modelValue===e.id}function S(e){c.value&&!c.value.contains(e.target)&&v()}function g(){a.value&&p()}A(()=>{document.addEventListener("click",S),window.addEventListener("resize",p),window.addEventListener("scroll",g,!0),document.body.addEventListener("scroll",g,!0)}),P(()=>{document.removeEventListener("click",S),window.removeEventListener("resize",p),window.removeEventListener("scroll",g,!0),document.body.removeEventListener("scroll",g,!0)});const F=b(()=>t.items.some(e=>(e[t.searchKey]||"").toString().toLowerCase()===(n.value||"").toLowerCase())),w=b(()=>t.taggable&&!!n.value&&!F.value);function E(){w.value&&(C("update:modelValue",n.value),v())}function I(){w.value&&E()}return(e,r)=>(u(),d("div",{class:"relative",ref_key:"dropdownWrapper",ref:c},[o("button",{onClick:H,disabled:t.disabled,type:"button",class:"w-full rounded-lg border border-gray-300 px-4 py-2.5 text-sm font-medium text-gray-700 bg-white dark:bg-gray-700 dark:text-white dark:border-gray-600 flex justify-between items-center hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed"},[o("span",ee,k(z.value),1),r[1]||(r[1]=o("svg",{class:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))],8,Z),W(o("div",{class:"fixed bg-white border border-gray-200 rounded-xl shadow-xl dark:bg-gray-700 dark:border-gray-600 z-[99999]",style:Y(L.value)},[o("div",te,[W(o("input",{"onUpdate:modelValue":r[0]||(r[0]=l=>n.value=l),type:"text",placeholder:"Cari...",onKeydown:q(G(I,["prevent"]),["enter"]),class:"w-full border border-gray-300 rounded-lg px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 dark:bg-gray-600 dark:text-white dark:border-gray-500"},null,40,oe),[[R,n.value]])]),o("ul",re,[y.taggable&&w.value?(u(),d("li",{key:0,class:"px-4 py-3 cursor-pointer flex items-center gap-3 text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-600 transition-colors duration-150",onClick:E},[r[2]||(r[2]=o("div",{class:"w-4 h-4 rounded-full border-2 border-blue-600 flex items-center justify-center"},[o("div",{class:"w-2 h-2 rounded-full bg-blue-600"})],-1)),o("span",le,'Tambah: "'+k(n.value)+'"',1)])):V("",!0),(u(!0),d(J,null,Q(K.value,l=>(u(),d("li",{key:l.id,class:M(["px-4 py-3 cursor-pointer flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors duration-150",{"bg-blue-50 dark:bg-blue-900/20":h(l)}]),onClick:s=>T(l)},[o("div",{class:M(["w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors duration-150",h(l)?"border-blue-600 bg-blue-600":"border-gray-300 dark:border-gray-500"])},[h(l)?(u(),d("div",ne)):V("",!0)],2),X(e.$slots,"item",{item:l},()=>[o("span",se,k(l.name),1)])],10,ae))),128)),!y.taggable&&K.value.length===0?(u(),d("li",ie,[...r[3]||(r[3]=[o("div",{class:"flex flex-col items-center gap-2"},[o("svg",{class:"w-8 h-8 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),o("span",{class:"text-sm"},"Tidak ada hasil")],-1)])])):V("",!0)])],4),[[U,a.value]])],512))}};export{ue as _};
