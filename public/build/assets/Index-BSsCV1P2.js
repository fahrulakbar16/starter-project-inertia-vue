import{d as h,y as S,z as B,U as se,e as p,o as u,b as n,a as e,g as f,D as oe,c as C,f as c,w as k,P as _,E as w,J as A,h as P,G as R,S as le,F as q,i as T,t as d,n as H,H as I}from"./app-CJkCV51W.js";import{_ as ne}from"./AppLayout-BlEKf3Fz.js";import{_ as de}from"./Breadcrumb-BJQpsGcc.js";import{_ as ue}from"./Pagination-C2dOEo8X.js";import{_ as ie}from"./ConfirmModal-DAlWp-FQ.js";import{P as pe}from"./PlusSquareIcon-DA_kLpvy.js";import{S as z}from"./ShowIcon-CiA5nZAB.js";import{E as Y}from"./EditIcon-B9T5EQzJ.js";import{T as J}from"./TrashIcon-DSAHmBPH.js";import{_ as K}from"./SelectPemakaian-bo5sz744.js";import"./FlashMessage-D4C-FUm8.js";import"./LayoutShell-FWpWJLvi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-DvuTgkfF.js";import"./LayoutShell.vue_vue_type_style_index_0_lang-CRqqKi3W.js";const ce={class:"flex overflow-hidden flex-col gap-3 px-3 h-full"},ge={class:"flex justify-between items-center h-10"},ye={class:"flex flex-col overflow-hidden rounded-lg border border-gray-200 bg-white dark:border-gray-600 dark:bg-white/[0.03]"},me={class:"flex flex-col gap-2 px-8 h-16 sm:flex-row sm:items-center sm:justify-between"},be={class:"flex gap-3 items-center"},xe={class:"overflow-auto overflow-x-auto","data-simplebar":""},fe={class:"min-w-full text-sm table-fixed"},ve={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},he={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},ke={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},_e={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},we={colspan:"3",class:"p-2 bg-gray-50 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-900"},qe={class:"relative space-x-4"},De={class:"px-2 py-2 bg-gray-50 border border-gray-200 dark:border-gray-600 dark:bg-gray-900"},Se={class:"px-2 py-2 bg-gray-50 border border-gray-200 dark:border-gray-600 dark:bg-gray-900"},Be={class:"px-2 py-2 bg-gray-50 border border-gray-200 dark:border-gray-600 dark:bg-gray-900"},Ce={class:"grid grid-cols-2 gap-2 w-72"},Pe={class:"px-2 py-2 bg-gray-50 border border-gray-200 dark:border-gray-600 dark:bg-gray-900"},je={key:0},Ve={key:0},$e={colspan:7,class:"px-4 py-2 font-semibold text-left text-gray-600 bg-gray-50 dark:bg-gray-900/40 dark:text-gray-300"},Re=["onClick"],Te={class:"text-xs"},Ie={class:"ml-1 text-xs font-medium text-gray-500"},Ge={class:"px-3 py-3 text-center"},Me={class:"px-3 py-3 font-mono text-center whitespace-nowrap"},Ne={class:"px-3 py-3 font-mono text-center whitespace-nowrap"},Ue={class:"px-3 py-3"},Ee={class:"px-3 py-3"},Le={class:"px-3 py-3 text-center"},Oe={class:"px-3 py-3"},Fe={class:"px-6 py-3"},Ae={class:"flex gap-2 items-center"},He=["onClick"],ze={class:"px-3 py-3 text-center"},Ye={class:"px-3 py-3 font-mono text-center whitespace-nowrap"},Je={class:"px-3 py-3 font-mono text-center whitespace-nowrap"},Ke={class:"px-3 py-3"},We={class:"px-3 py-3 w-72"},Qe={class:"px-3 py-3 text-center"},Xe={class:"px-3 py-3 text-center"},Ze={class:"px-6 py-3"},et={class:"flex gap-2 items-center justify-between"},tt=["onClick"],rt={components:{SortIcon:{props:{active:Boolean,direction:String},template:`
                <span class="inline-block ml-2 text-xs">
                    <template v-if="active">
                        {{ direction === 'asc' ? 'â–²' : 'â–¼' }}
                    </template>
                    <template v-else>
                        â‡…
                    </template>
                </span>
            `}}},vt=Object.assign(rt,{layout:ne},{__name:"Index",props:{purchaseRequests:{type:Object,required:!0},departments:{type:Array,required:!0},employees:{type:Array,required:!0},filters:{type:Object,default:()=>({})},sortBy:{type:String,default:"requested_at"},sortDirection:{type:String,default:"desc"},groupBy:{type:String,default:null},can_edit:{type:Boolean,default:!1},can_delete:{type:Boolean,default:!1},can_view:{type:Boolean,default:!1},can_create:{type:Boolean,default:!1}},setup(s){const W=[{label:"Penyimpanan"},{label:"Pengajuan Barang"}],l=s,o=h({q:l.filters.q??"",employee_id:l.filters.employee_id??null,department_id:l.filters.department_id??null,date_from:l.filters.date_from??"",date_to:l.filters.date_to??"",status:l.filters.status??""}),b=h(l.groupBy??"all"),x=S(()=>b.value||(l.groupBy??"all")),G=S(()=>!!x.value),j=h(!1),v=h(null),M=S(()=>{const r={},t=((l.purchaseRequests.current_page||1)-1)*(l.purchaseRequests.per_page||20);return(l.purchaseRequests.data||[]).forEach((a,y)=>{r[a.id]=t+y+1}),r}),V=h(new Set),Q=S(()=>{if(!G.value)return{};const r=l.purchaseRequests.data||[],t={};for(const g of r){const a=X(g);t[a]||(t[a]=[]),t[a].push(g)}return t});function X(r){switch(x.value){case"department":return r.department??"Tanpa Departemen";case"requested_by":return r.requested_by??"Tanpa Pemohon";case"status":return $(r.status);default:return"ungrouped"}}function Z(r){switch(x.value){case"department":return`Departemen: ${r}`;case"requested_by":return`Diminta oleh: ${r}`;case"status":return`Status: ${r}`;default:return r}}function N(r){return V.value.has(r)}function ee(r){const t=new Set(V.value);t.has(r)?t.delete(r):t.add(r),V.value=t}function m({sortBy:r=l.sortBy,sortDirection:t=l.sortDirection}={}){I.get(route("purchase-requests.index"),{...o.value,groupBy:x.value||null,sortBy:r,sortDirection:t},{preserveScroll:!0,preserveState:!0,replace:!0,onStart:()=>{typeof window<"u"&&(window.__suppressProgress=!0)},onFinish:()=>{typeof window<"u"&&(window.__suppressProgress=!1)}})}let U;B(()=>o.value.q,()=>{clearTimeout(U),U=setTimeout(()=>m({}),400)}),B(()=>[o.value.department_id,o.value.employee_id,o.value.status,o.value.date_from,o.value.date_to],()=>{m({})}),B(b,()=>{E(),m({})}),B(()=>l.groupBy,r=>{!b.value&&r&&(b.value=r)});function D(r){const t=l.sortBy===r&&l.sortDirection==="asc"?"desc":"asc";m({sortBy:r,sortDirection:t})}function E(){o.value={q:"",employee_id:null,department_id:null,date_from:"",date_to:"",status:""},m({})}function $(r){return{on_progress:"Menunggu Persetujuan",approved:"Disetujui",rejected:"Ditolak",canceled:"Dibatalkan",partial_approved:"Disetujui Sebagian"}[r]??r}function L(r){return{on_progress:"bg-yellow-100 text-yellow-800 dark:bg-yellow-500/20 dark:text-yellow-300",approved:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300",rejected:"bg-rose-100 text-rose-800 dark:bg-rose-500/20 dark:text-rose-300",canceled:"bg-slate-100 text-slate-700 dark:bg-slate-500/20 dark:text-slate-300",partial_approved:"bg-violet-100 text-violet-800 dark:bg-violet-500/20 dark:text-violet-300"}[r]??"bg-gray-100 text-gray-700"}function O(r){r?.id&&(v.value=r,j.value=!0)}function F(){j.value=!1,v.value=null}function te(){v.value?.id&&I.delete(route("purchase-requests.destroy",v.value.id),{preserveScroll:!0,onSuccess:()=>{F(),m({})}})}function re(r){m({})}function ae(r){I.get(route("purchase-requests.index"),{...o.value,groupBy:x.value||null,sortBy:l.sortBy,sortDirection:l.sortDirection,per_page:r},{preserveScroll:!0,preserveState:!0,replace:!0})}return(r,t)=>{const g=se("SortIcon");return u(),p(q,null,[n(f(oe),{title:"Pengajuan Pembelian"}),e("div",ce,[e("div",ge,[n(de,{items:W}),s.can_create?(u(),C(f(_),{key:0,href:r.route("purchase-requests.create"),class:"inline-flex items-center gap-2 text-white hover:text-blue-500 rounded-md border hover:border-gray-300 bg-blue-500 px-3 py-2 text-sm font-medium text-white-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] dark:hover:text-gray-200"},{default:k(()=>[n(pe),t[11]||(t[11]=e("span",{class:"hidden md:block"},"Buat Pengajuan",-1))]),_:1},8,["href"])):c("",!0)]),e("div",ye,[e("div",me,[t[13]||(t[13]=e("div",{class:"font-bold text-gray-700 md:text-xl dark:text-gray-300"}," Daftar Pengajuan Pembelian ",-1)),e("div",be,[e("div",null,[w(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>b.value=a),class:"px-3 h-10 text-sm text-gray-800 bg-transparent rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},[...t[12]||(t[12]=[e("option",{value:"all"},"Kelompokan Berdasarkan",-1),e("option",{value:"department"}," Group: Departemen ",-1),e("option",{value:"requested_by"}," Group: Diminta oleh ",-1),e("option",{value:"status"},"Group: Status",-1)])],512),[[A,b.value]])])])]),e("div",xe,[e("table",fe,[t[25]||(t[25]=e("colgroup",null,[e("col",{style:{width:"30px"}}),e("col",{style:{width:"160px"}}),e("col",{style:{width:"200px"}}),e("col",{style:{width:"220px"}}),e("col",{style:{width:"160px"}}),e("col",{style:{width:"140px"}}),e("col",{style:{width:"140px"}})],-1)),e("thead",null,[e("tr",null,[t[18]||(t[18]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," No. ")],-1)),t[19]||(t[19]=e("th",{class:"py-2.5 whitespace-nowrap border-y border-gray-200 bg-gray-100 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," No. Request ")],-1)),t[20]||(t[20]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium whitespace-nowrap text-gray-600 dark:text-gray-300"}," No. Referensi (MR) ")],-1)),e("th",ve,[e("button",{onClick:t[1]||(t[1]=a=>D("requested_by")),class:"px-3 w-full font-medium text-left text-gray-600 dark:text-gray-300 whitespace-nowrap"},[t[14]||(t[14]=P(" Pengajuan oleh ",-1)),n(g,{active:s.sortBy==="requested_by",direction:s.sortDirection},null,8,["active","direction"])])]),e("th",he,[e("button",{onClick:t[2]||(t[2]=a=>D("department")),class:"px-3 w-full font-medium text-left text-gray-600 dark:text-gray-300 whitespace-nowrap"},[t[15]||(t[15]=P(" Departemen ",-1)),n(g,{active:s.sortBy==="department",direction:s.sortDirection},null,8,["active","direction"])])]),e("th",ke,[e("button",{onClick:t[3]||(t[3]=a=>D("requested_at")),class:"px-3 w-full font-medium text-left text-gray-600 dark:text-gray-300"},[t[16]||(t[16]=P(" Tanggal Pengajuan ",-1)),n(g,{active:s.sortBy==="requested_at",direction:s.sortDirection},null,8,["active","direction"])])]),e("th",_e,[e("button",{onClick:t[4]||(t[4]=a=>D("status")),class:"px-3 w-full font-medium text-left text-gray-600 dark:text-gray-300"},[t[17]||(t[17]=P(" Status ",-1)),n(g,{active:s.sortBy==="status",direction:s.sortDirection},null,8,["active","direction"])])]),t[21]||(t[21]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," Aksi ")],-1))]),e("tr",null,[e("th",we,[e("div",qe,[w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>o.value.q=a),type:"text",placeholder:"Cari nomor request / nama pemohon",class:"rounded-lg border border-gray-200 bg-transparent py-2.5 pl-4 pr-14 text-sm text-gray-800 focus:border-blue-300 focus:outline-hidden focus:ring-2 focus:ring-blue-500/20"},null,512),[[R,o.value.q]]),t[22]||(t[22]=e("span",{class:"absolute right-10 top-1/2 -translate-y-1/2 text-gray-400"},"ðŸ”",-1))])]),e("th",De,[n(K,{modelValue:o.value.employee_id,"onUpdate:modelValue":t[6]||(t[6]=a=>o.value.employee_id=a),items:[{id:null,name:"Semua"},...s.employees],label:"Pilih Pemohon",class:"w-full text-xs sm:text-sm"},null,8,["modelValue","items"])]),e("th",Se,[n(K,{modelValue:o.value.department_id,"onUpdate:modelValue":t[7]||(t[7]=a=>o.value.department_id=a),items:[{id:null,name:"Semua"},...s.departments],label:"Pilih Departemen",class:"w-full text-xs sm:text-sm"},null,8,["modelValue","items"])]),e("th",Be,[e("div",Ce,[w(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>o.value.date_from=a),type:"date",class:"px-2 w-full h-10 text-xs rounded border-gray-300 sm:text-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},null,512),[[R,o.value.date_from]]),w(e("input",{"onUpdate:modelValue":t[9]||(t[9]=a=>o.value.date_to=a),type:"date",class:"px-2 w-full h-10 text-xs rounded border-gray-300 sm:text-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},null,512),[[R,o.value.date_to]])])]),e("th",Pe,[w(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>o.value.status=a),class:"px-3 w-54 h-10 text-xs rounded border-gray-300 sm:text-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},[...t[23]||(t[23]=[le('<option value="">Semua</option><option value="on_progress"> Menunggu Persetujuan </option><option value="approved">Disetujui</option><option value="rejected">Ditolak</option><option value="canceled">Dibatalkan</option><option value="partial_approved"> Disetujui Sebagian </option>',6)])],512),[[A,o.value.status]])]),e("th",{class:"px-2 py-2 bg-gray-50 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-900"},[e("button",{onClick:E,class:"px-3 py-2 text-xs rounded bg-red-500 text-white hover:bg-red-600"}," Clear ")])])]),e("tbody",null,[!s.purchaseRequests.data||s.purchaseRequests.data.length===0?(u(),p("tr",je,[...t[24]||(t[24]=[e("td",{colspan:"7",class:"py-8 text-center text-gray-500"}," Tidak ada data pengadaan. ",-1)])])):c("",!0),G.value?(u(!0),p(q,{key:1},T(Q.value,(a,y)=>(u(),p(q,{key:y},[x.value!=="all"?(u(),p("tr",Ve,[e("td",$e,[e("button",{class:"inline-flex gap-2 items-center",onClick:i=>ee(y)},[e("span",Te,d(N(y)?"â–¶":"â–¼"),1),e("span",null,d(Z(y)),1),e("span",Ie,"("+d(a.length)+")",1)],8,Re)])])):c("",!0),N(y)?c("",!0):(u(!0),p(q,{key:1},T(a,i=>(u(),p("tr",{key:i.id,class:"border-b border-gray-200 dark:border-gray-700"},[e("td",Ge,d(M.value[i.id]??"-")+". ",1),e("td",Me,d(i.request_no),1),e("td",Ne,d(i.mr_no??"-"),1),e("td",Ue,d(i.requested_by),1),e("td",Ee,d(i.department),1),e("td",Le,d(i.requested_at),1),e("td",Oe,[e("span",{class:H([L(i.status),"px-2.5 py-1 text-xs font-medium rounded-full"])},d($(i.status)),3)]),e("td",Fe,[e("div",Ae,[n(f(_),{href:r.route("purchase-requests.show",i.id)},{default:k(()=>[n(z,{class:"text-blue-400"})]),_:1},8,["href"]),s.can_edit&&i.status==="on_progress"?(u(),C(f(_),{key:0,href:r.route("purchase-requests.edit",i.id)},{default:k(()=>[n(Y,{class:"text-yellow-500"})]),_:1},8,["href"])):c("",!0),s.can_delete?(u(),p("button",{key:1,type:"button",onClick:at=>O(i)},[n(J,{class:"text-red-500"})],8,He)):c("",!0)])])]))),128))],64))),128)):(u(!0),p(q,{key:2},T(s.purchaseRequests.data,a=>(u(),p("tr",{key:a.id,class:"border-b border-gray-200 dark:border-gray-700"},[e("td",ze,d(M.value[a.id]??"-")+". ",1),e("td",Ye,d(a.request_no),1),e("td",Je,d(a.mr_no??"-"),1),e("td",Ke,d(a.requested_by),1),e("td",We,d(a.department),1),e("td",Qe,d(a.requested_at),1),e("td",Xe,[e("span",{class:H([L(a.status),"px-2.5 py-1 text-xs font-medium rounded-full"])},d($(a.status)),3)]),e("td",Ze,[e("div",et,[s.can_view?(u(),C(f(_),{key:0,href:r.route("purchase-requests.show",a.id)},{default:k(()=>[n(z,{class:"text-blue-400"})]),_:1},8,["href"])):c("",!0),s.can_edit&&a.status==="on_progress"?(u(),C(f(_),{key:1,href:r.route("purchase-requests.edit",a.id)},{default:k(()=>[n(Y,{class:"text-yellow-500"})]),_:1},8,["href"])):c("",!0),s.can_delete?(u(),p("button",{key:2,type:"button",onClick:y=>O(a)},[n(J,{class:"text-red-500"})],8,tt)):c("",!0)])])]))),128))])]),n(ue,{pagination:s.purchaseRequests,onPageChange:re,onPerPageChange:ae,class:"border-t"},null,8,["pagination"])]),n(ie,{show:j.value,question:"Yakin ingin menghapus purchase request",selected:`${v.value?.request_no||"ini"}`,title:"Hapus Purchase Request",confirmText:"Ya, Hapus!",maxWidth:"md",onClose:F,onConfirm:te},null,8,["show","selected"])])])],64)}}});export{vt as default};
