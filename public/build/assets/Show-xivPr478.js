import{y as B,d as f,z as W,e as r,o as s,b as D,a as e,g as i,D as Y,f as y,h as G,n as h,t as o,F as k,i as N,S as J,E as M,G as R,H as Q}from"./app-CJkCV51W.js";import{_ as X}from"./Breadcrumb-BJQpsGcc.js";import{_ as Z}from"./ConfirmModal-DAlWp-FQ.js";import{_ as ee}from"./AppLayout-BlEKf3Fz.js";import"./FlashMessage-D4C-FUm8.js";import"./LayoutShell-FWpWJLvi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-DvuTgkfF.js";import"./LayoutShell.vue_vue_type_style_index_0_lang-CRqqKi3W.js";const te={class:"flex overflow-hidden flex-col gap-3 px-3 h-full"},ae={class:"flex justify-between items-center h-10"},re={class:"flex items-center gap-2"},se={class:"flex flex-col gap-4 overflow-hidden rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-600 dark:bg-white/[0.03]"},oe={class:"flex items-center justify-between"},ie={class:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-3"},ne={class:"font-semibold text-gray-800 dark:text-gray-200"},de={class:"font-semibold text-gray-800 dark:text-gray-200"},le={class:"font-semibold text-gray-800 dark:text-gray-200"},ce={class:"font-semibold text-gray-800 dark:text-gray-200"},ue={class:"font-semibold text-gray-800 dark:text-gray-200"},me={key:0},ge={class:"font-semibold text-gray-800 dark:text-gray-200"},ye={class:"md:col-span-2 xl:col-span-3"},xe={class:"font-semibold text-gray-800 dark:text-gray-200 whitespace-pre-line"},pe={class:"flex flex-col overflow-hidden rounded-lg border border-gray-200 bg-white dark:border-gray-600 dark:bg-white/[0.03]"},fe={class:"flex items-center gap-2 px-4 border-b border-gray-200 dark:border-gray-700"},be={key:0,class:"overflow-auto","data-simplebar":""},ve={class:"min-w-full text-sm table-fixed"},he={key:0},_e={class:"px-3 py-2"},ke={class:"px-3 py-2"},we={class:"px-3 py-2 font-mono"},Ce={class:"px-3 py-2"},Te={class:"px-3 py-2"},qe={key:1,class:"text-gray-400"},je={class:"px-3 py-2"},Se={class:"px-3 py-2"},Be={class:"px-3 py-2"},De={key:0,class:"text-sm text-gray-700 bg-green-50 px-2 py-1 rounded"},Ne={key:1,class:"text-gray-400"},Qe={key:1,class:"p-6"},Ve={key:0,class:"text-sm text-gray-500"},Me={key:1,class:"space-y-3"},Re={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},Pe={class:"text-xs text-gray-500"},ze={class:"text-sm text-gray-700 dark:text-gray-300"},Ee={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},$e={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ae={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"},He={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Ie={class:"mt-6"},Ke={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},Oe={class:"min-w-full divide-y divide-gray-300"},Ue={class:"bg-white divide-y divide-gray-200"},Le={class:"px-6 py-4 whitespace-nowrap"},Fe={class:"text-sm font-medium text-gray-900"},We={class:"text-sm text-gray-500"},Ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ge=["value"],Je={class:"px-6 py-4 whitespace-nowrap"},Xe={class:"flex items-center gap-2"},Ze=["onUpdate:modelValue","max","placeholder"],et={key:0,class:"text-orange-500 text-xs",title:"Catatan wajib diisi"},tt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},at={class:"px-6 py-4"},rt=["onUpdate:modelValue","placeholder"],st={key:0,class:"text-xs text-red-600 mt-1"},yt=Object.assign({layout:ee},{__name:"Show",props:{goodTransfer:{type:Object,required:!0},items:{type:Array,default:()=>[]},activities:{type:Array,default:()=>[]},user:{type:Object,required:!0},isSuperadmin:{type:Boolean,required:!0}},setup(P){const n=P;console.log("goodTransfer",n.goodTransfer),console.log("items",n.items),console.log("activities",n.activities),console.log("user",n.user.employee),console.log("isSuperadmin",n.isSuperadmin);const z=B(()=>n.isSuperadmin||n.user.employee?.branch_id==n.goodTransfer.to_branch_id),E=B(()=>n.isSuperadmin||n.user.employee?.branch_id==n.goodTransfer.from_branch_id&&n.goodTransfer.status=="Shipped"),d=n.goodTransfer,u=n.items,w=n.activities,$=[{label:"Penyimpanan",href:route("dashboard")},{label:"Pemindahan Barang",href:route("good-transfers.index")},{label:d.transfer_no}],b=f("items"),C=f(!1),A=f(null),p=f({title:"",question:"",confirmText:"",action:null}),T=f(!1),g=f([]),v=f([]);W(g,()=>{},{deep:!0}),B(()=>n.user.roles?.includes("Superadmin")?!0:n.goodTransfer.sent_by_id===n.user.employee?.id);function H(m){return{Shipped:"Dikirim",Received:"Diterima",Canceled:"Dibatalkan"}[m]??m}function I(m){return{Shipped:"bg-yellow-100 text-yellow-800 dark:bg-yellow-500/20 dark:text-yellow-300",Received:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300",Canceled:"bg-rose-100 text-rose-800 dark:bg-rose-500/20 dark:text-rose-300"}[m]??"bg-gray-100 text-gray-700"}function K(){T.value=!0,g.value=u?.map(m=>m.quantity_transferred||0)||[],v.value=u?.map(()=>"")||[]}function O(){p.value={title:"Batalkan Pemindahan Barang",question:"Yakin ingin membatalkan pemindahan barang ini?",confirmText:"Ya, Batalkan!",action:"cancel"},C.value=!0}function q(){C.value=!1,A.value=null,p.value={title:"",question:"",confirmText:"",action:null}}function U(){p.value.action==="receive"?Q.post(route("good-transfers.receive",d.id),{},{preserveScroll:!0,onSuccess:()=>{q()}}):p.value.action==="cancel"&&Q.post(route("good-transfers.cancel",d.id),{},{preserveScroll:!0,onSuccess:()=>{q()}})}function _(m){const t=u[m]?.quantity_transferred||0;return(g.value[m]||0)!==t}function j(){T.value=!1,g.value=[],v.value=[]}function L(){if(g.value.some(c=>c==null||c==="")){alert("Mohon isi semua jumlah barang yang diterima");return}if(g.value.some((c,x)=>{const S=u[x]?.quantity_transferred||0;return c>S})){alert("Jumlah diterima tidak boleh melebihi jumlah yang dikirim");return}if(g.value.some((c,x)=>{const S=u[x]?.quantity_transferred||0,V=v.value[x]||"";return c!==S&&(!V||V.trim()==="")})){alert("Catatan penerimaan wajib diisi untuk item yang jumlahnya tidak sesuai dengan yang dikirim");return}const l={quantities:g.value.map((c,x)=>({item_id:u[x].id,quantity_transferred:u[x].quantity_transferred,quantity_received:c,receive_note:v.value[x]||""}))};Q.post(route("good-transfers.receive",d.id),l,{onSuccess:()=>{j(),window.location.reload()},onError:c=>{console.error("Error receiving goods:",c),alert("Terjadi kesalahan saat menyimpan data")}})}function F(){window.open(route("good-transfers.print-receipt",d.id),"_blank")}return(m,t)=>(s(),r(k,null,[D(i(Y),{title:`Pemindahan Barang ${i(d).transfer_no}`},null,8,["title"]),e("div",te,[e("div",ae,[D(X,{items:$}),e("div",re,[i(d).status==="Shipped"&&z.value?(s(),r("button",{key:0,onClick:K,class:"inline-flex items-center rounded bg-emerald-600 px-3 py-2 text-sm font-medium text-white hover:bg-emerald-700"},"Terima Barang")):y("",!0),E.value?(s(),r("button",{key:1,onClick:O,class:"inline-flex items-center rounded bg-red-600 px-3 py-2 text-sm font-medium text-white hover:bg-red-700"},"Batalkan")):y("",!0),e("button",{onClick:F,class:"inline-flex items-center rounded bg-gray-600 px-3 py-2 text-sm font-medium text-white hover:bg-gray-700"},[...t[2]||(t[2]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1),G(" Cetak Nota ",-1)])])])]),e("div",se,[e("div",oe,[t[3]||(t[3]=e("div",{class:"font-bold text-gray-700 md:text-xl dark:text-gray-300"},"Informasi Pemindahan Barang",-1)),e("div",null,[e("span",{class:h([I(i(d).status),"px-2.5 py-1 rounded-full text-xs font-medium"])},o(H(i(d).status)),3)])]),e("div",ie,[e("div",null,[t[4]||(t[4]=e("div",{class:"text-xs text-gray-500"},"No. Transfer",-1)),e("div",ne,o(i(d).transfer_no),1)]),e("div",null,[t[5]||(t[5]=e("div",{class:"text-xs text-gray-500"},"Dari Cabang",-1)),e("div",de,o(i(d).from_branch),1)]),e("div",null,[t[6]||(t[6]=e("div",{class:"text-xs text-gray-500"},"Ke Cabang",-1)),e("div",le,o(i(d).to_branch),1)]),e("div",null,[t[7]||(t[7]=e("div",{class:"text-xs text-gray-500"},"Dikirim oleh",-1)),e("div",ce,o(i(d).sent_by),1)]),e("div",null,[t[8]||(t[8]=e("div",{class:"text-xs text-gray-500"},"Tanggal Transfer",-1)),e("div",ue,o(i(d).transferred_at),1)]),i(d).received_by?(s(),r("div",me,[t[9]||(t[9]=e("div",{class:"text-xs text-gray-500"},"Diterima oleh",-1)),e("div",ge,o(i(d).received_by),1)])):y("",!0),e("div",ye,[t[10]||(t[10]=e("div",{class:"text-xs text-gray-500"},"Tujuan",-1)),e("div",xe,o(i(d).purpose||"-"),1)])])]),e("div",pe,[e("div",fe,[e("button",{class:h(["px-4 py-3 text-sm font-medium",b.value==="items"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 dark:text-gray-300"]),onClick:t[0]||(t[0]=a=>b.value="items")}," Daftar Item ",2),e("button",{class:h(["px-4 py-3 text-sm font-medium",b.value==="activities"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 dark:text-gray-300"]),onClick:t[1]||(t[1]=a=>b.value="activities")}," Aktivitas Log ",2)]),b.value==="items"?(s(),r("div",be,[e("table",ve,[t[12]||(t[12]=e("colgroup",null,[e("col",{style:{width:"60px"}}),e("col",{style:{width:"200px"}}),e("col",{style:{width:"150px"}}),e("col",{style:{width:"100px"}}),e("col",{style:{width:"100px"}}),e("col",{style:{width:"100px"}}),e("col",{style:{width:"120px"}}),e("col")],-1)),t[13]||(t[13]=e("thead",null,[e("tr",null,[e("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"No")]),e("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Nama Item")]),e("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Kode")]),e("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Qty Dikirim")]),e("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Qty Diterima")]),e("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Satuan")]),e("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Catatan")]),e("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Catatan Penerimaan")])])],-1)),e("tbody",null,[!i(u)||i(u).length===0?(s(),r("tr",he,[...t[11]||(t[11]=[e("td",{colspan:"8",class:"text-center py-8 text-gray-500"},"Tidak ada item",-1)])])):y("",!0),(s(!0),r(k,null,N(i(u),(a,l)=>(s(),r("tr",{key:a.id,class:"border-b border-gray-200 dark:border-gray-700"},[e("td",_e,o(l+1),1),e("td",ke,o(a.item_name),1),e("td",we,o(a.item_code),1),e("td",Ce,o(a.quantity_transferred),1),e("td",Te,[a.quantity_received!==null&&a.quantity_received!==void 0?(s(),r("span",{key:0,class:h(a.quantity_received>0?"text-green-600 font-semibold":"text-gray-500")},o(a.quantity_received||0),3)):(s(),r("span",qe,"-"))]),e("td",je,o(a.unit),1),e("td",Se,o(a.note||"-"),1),e("td",Be,[a.note_received?(s(),r("span",De,o(a.note_received),1)):(s(),r("span",Ne,"-"))])]))),128))])])])):y("",!0),b.value==="activities"?(s(),r("div",Qe,[!i(w)||i(w).length===0?(s(),r("div",Ve,"Belum ada aktivitas.")):(s(),r("ul",Me,[(s(!0),r(k,null,N(i(w),(a,l)=>(s(),r("li",{key:l,class:"flex gap-3 items-start"},[t[14]||(t[14]=e("div",{class:"mt-1 h-2 w-2 rounded-full bg-blue-500"},null,-1)),e("div",null,[e("div",Re,o(a.title),1),e("div",Pe,o(a.time),1),e("div",ze,o(a.description),1)])]))),128))]))])):y("",!0)]),D(Z,{show:C.value,question:p.value.question,selected:i(d).transfer_no,title:p.value.title,confirmText:p.value.confirmText,maxWidth:"md",onClose:q,onConfirm:U},null,8,["show","question","selected","title","confirmText"]),T.value?(s(),r("div",Ee,[e("div",$e,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:j}),t[17]||(t[17]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",Ae,[e("div",He,[t[16]||(t[16]=J('<div class="sm:flex sm:items-start"><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-emerald-100 sm:mx-0 sm:h-10 sm:w-10"><svg class="h-6 w-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"><h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title"> Konfirmasi Penerimaan Barang </h3><div class="mt-2"><p class="text-sm text-gray-500"> Masukkan jumlah barang yang diterima untuk setiap item: </p></div></div></div>',1)),e("div",Ie,[e("div",Ke,[e("table",Oe,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Qty Dikirim"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Qty Diterima"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Satuan"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Catatan")])],-1)),e("tbody",Ue,[(s(!0),r(k,null,N(i(u),(a,l)=>(s(),r("tr",{key:a.id},[e("td",Le,[e("div",Fe,o(a.item_name),1),e("div",We,o(a.item_code),1)]),e("td",Ye,[e("input",{type:"number",value:a.quantity_transferred,readonly:"",class:"w-20 px-3 py-1 border rounded-md bg-gray-100 text-gray-700 border-gray-300 focus:outline-none"},null,8,Ge)]),e("td",Je,[e("div",Xe,[M(e("input",{"onUpdate:modelValue":c=>g.value[l]=c,type:"number",min:"0",max:a.quantity_transferred,class:h(["w-20 px-3 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",_(l)?"border-orange-300 bg-orange-50":"border-gray-300"]),placeholder:a.quantity_transferred},null,10,Ze),[[R,g.value[l]]]),_(l)?(s(),r("span",et," ⚠️ ")):y("",!0)])]),e("td",tt,o(a.unit),1),e("td",at,[M(e("input",{"onUpdate:modelValue":c=>v.value[l]=c,type:"text",class:h(["w-full px-3 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",_(l)?"border-red-300 bg-red-50":"border-gray-300"]),placeholder:_(l)?"Catatan wajib diisi!":"Catatan item (opsional)"},null,10,rt),[[R,v.value[l]]]),_(l)?(s(),r("div",st," * Wajib diisi karena jumlah tidak sesuai ")):y("",!0)])]))),128))])])])])]),e("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[e("button",{onClick:L,type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-emerald-600 text-base font-medium text-white hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 sm:ml-3 sm:w-auto sm:text-sm"}," Konfirmasi Diterima "),e("button",{onClick:j,type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Batal ")])])])])):y("",!0)])],64))}});export{yt as default};
