import{d as y,y as w,z as b,L as x,l as M,e as d,o as i,a as r,E as g,f as n,G as p,t as l,b as k,w as q}from"./app-CJkCV51W.js";import{_ as v}from"./SelectPemakaian-bo5sz744.js";const R={class:"space-y-4"},E={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},B={class:"space-y-1"},D={key:0,class:"mt-1 text-sm text-red-500"},N={class:"space-y-2"},U={key:0,class:"mt-1 text-xs text-rose-600"},P={class:"space-y-2"},S={class:"relative"},T={key:0,class:"absolute right-3 top-1/2 transform -translate-y-1/2"},A={key:0,class:"mt-1 text-xs text-rose-600"},C={class:"col-span-3"},O={key:0,class:"mt-1 text-xs text-rose-600"},F={__name:"Form",props:{form:{type:Object,required:!0},departments:{type:Array,required:!0},materialRequests:{type:Array,required:!0},isSuperadmin:{type:Boolean,required:!0},isEdit:{type:Boolean,default:!1}},emits:["items-loaded","reset-items"],setup(t,{emit:h}){const o=t,m=y([]),u=y(!1),V=w(()=>{const s={id:null,request_no:"Tanpa Referensi"},e=m.value.length>0?m.value:[];return[s,...e]}),f=h,c=async s=>{if(!s){m.value=[];return}u.value=!0;try{const e=await x.get(route("material-requests.requests"),{params:{department_id:s}});m.value=e.data.materialRequests||[]}catch(e){console.error("Error loading MRs by department:",e),m.value=[]}finally{u.value=!1}};return b(()=>o.form.department_id,s=>{o.form.request_id=null,c(s)}),b(()=>o.form.request_id,async s=>{if(!s||s===null){o.isEdit||(f("items-loaded",[]),f("reset-items"));return}try{const e=await x.get(route("material-requests.items.by-request"),{params:{request_id:s}});f("items-loaded",e.data.items)}catch(e){console.error("Error loading MR items:",e),f("items-loaded",[])}},{immediate:!o.isEdit}),M(()=>{o.form.department_id&&c(o.form.department_id)}),(s,e)=>(i(),d("form",R,[r("div",E,[r("div",B,[e[4]||(e[4]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Tanggal Permintaan",-1)),g(r("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.form.date=a),type:"date",class:"h-10 ps-0 pe-5 w-full border-0 border-b-2 border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},null,512),[[p,t.form.date]]),t.form.errors.date?(i(),d("p",D,l(t.form.errors.date[0]),1)):n("",!0)]),r("div",N,[e[5]||(e[5]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Departemen",-1)),k(v,{modelValue:t.form.department_id,"onUpdate:modelValue":e[1]||(e[1]=a=>t.form.department_id=a),label:"Pilih departemen",items:o.user?.department?[o.user.department]:t.departments,disabled:!t.isSuperadmin},{item:q(({item:a})=>[r("span",null,l(a.name)+l(a.branch?" - "+a.branch.name:""),1)]),_:1},8,["modelValue","items","disabled"]),t.form.errors.department_id?(i(),d("p",U,l(t.form.errors.department_id[0]),1)):n("",!0)]),r("div",P,[e[7]||(e[7]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Referensi MR",-1)),r("div",S,[k(v,{modelValue:t.form.request_id,"onUpdate:modelValue":e[2]||(e[2]=a=>t.form.request_id=a),label:"Pilih nomor request","label-key":"request_no","search-key":"request_no",items:V.value,disabled:u.value},{item:q(({item:a})=>[r("span",null,l(a.request_no),1)]),_:1},8,["modelValue","items","disabled"]),u.value?(i(),d("div",T,[...e[6]||(e[6]=[r("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"},null,-1)])])):n("",!0)]),t.form.errors.employee_id?(i(),d("p",A,l(t.form.errors.employee_id[0]),1)):n("",!0)]),r("div",C,[e[8]||(e[8]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Keperluan",-1)),g(r("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.form.requirement=a),rows:"2",placeholder:"Masukkan keperluan permintaan barang",class:"mt-1 w-full rounded-md text-sm border-gray-300 placeholder:text-gray-400 dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},null,512),[[p,t.form.requirement]]),t.form.errors.requirement?(i(),d("p",O,l(t.form.errors.requirement[0]),1)):n("",!0)])])]))}};export{F as default};
