import{d as k,z as w,y as P,U as le,e as g,o as u,b as d,a as e,g as x,D as de,c as B,f as p,w as C,P as D,E as V,J as ne,h as v,G as T,F as S,i as U,t as l,n as $,H as R}from"./app-CJkCV51W.js";import{_ as ie}from"./AppLayout-BlEKf3Fz.js";import{_ as ue}from"./Breadcrumb-BJQpsGcc.js";import{_ as ce}from"./Pagination-C2dOEo8X.js";import{_ as ye}from"./ConfirmModal-DAlWp-FQ.js";import{P as ge}from"./PlusSquareIcon-DA_kLpvy.js";import{S as Y}from"./ShowIcon-CiA5nZAB.js";import{_ as L}from"./SelectPemakaian-bo5sz744.js";import{E as J}from"./EditIcon-B9T5EQzJ.js";import{T as K}from"./TrashIcon-DSAHmBPH.js";import"./FlashMessage-D4C-FUm8.js";import"./LayoutShell-FWpWJLvi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-DvuTgkfF.js";import"./LayoutShell.vue_vue_type_style_index_0_lang-CRqqKi3W.js";const pe={class:"flex flex-col h-full gap-3 px-3 overflow-hidden"},me={class:"flex items-center justify-between h-10"},be={class:"flex flex-col overflow-hidden rounded-lg border border-gray-200 bg-white dark:border-gray-600 dark:bg-white/[0.03]"},fe={class:"flex flex-col h-16 gap-2 px-8 sm:flex-row sm:items-center sm:justify-between"},xe={class:"flex items-center gap-3"},ve={class:"overflow-auto overflow-x-auto","data-simplebar":""},he={class:"min-w-full text-sm table-fixed"},_e={class:"py-2.5 whitespace-nowrap border-y border-gray-200 bg-gray-100 dark:border-gray-600 dark:bg-gray-800"},ke={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},we={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},Be={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},Ce={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},De={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},Se={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},Pe={colspan:"4",class:"p-2 border-gray-200 bg-gray-50 border-y dark:border-gray-600 dark:bg-gray-900"},Ve={class:"relative space-x-4"},$e={class:"px-2 py-2 border border-gray-200 bg-gray-50 dark:border-gray-600 dark:bg-gray-900"},Oe={class:"px-2 py-2 border border-gray-200 bg-gray-50 dark:border-gray-600 dark:bg-gray-900"},qe={class:"px-2 py-2 border border-gray-200 bg-gray-50 dark:border-gray-600 dark:bg-gray-900"},Te={class:"px-2 py-2 border border-gray-200 bg-gray-50 dark:border-gray-600 dark:bg-gray-900"},Ue={class:"grid grid-cols-2 gap-2 w-72"},Le={key:0},Ie={key:0},Ge={colspan:9,class:"px-4 py-2 font-semibold text-left text-gray-600 bg-gray-50 dark:bg-gray-900/40 dark:text-gray-300"},Ne=["onClick"],je={class:"text-xs"},Ee={class:"ml-1 text-xs font-medium text-gray-500"},Fe={class:"px-3 py-3 text-center"},Me={class:"px-3 py-3 font-mono text-center whitespace-nowrap"},Ae={class:"px-3 py-3 font-mono text-center whitespace-nowrap"},He={class:"px-3 py-3"},ze={class:"px-3 py-3"},Re={class:"px-3 py-3"},Ye={class:"px-3 py-3"},Je={class:"px-3 py-3 text-center"},Ke={class:"px-3 py-3"},We={class:"px-6 py-3"},Qe={class:"flex items-center gap-2"},Xe=["onClick"],Ze={class:"px-3 py-3 text-center"},et={class:"px-3 py-3 font-mono text-center whitespace-nowrap"},tt={class:"px-3 py-3 font-mono text-center whitespace-nowrap"},rt={class:"px-3 py-3"},at={class:"px-3 py-3"},st={class:"px-3 py-3"},ot={class:"px-3 py-3"},lt={class:"px-3 py-3 text-center"},dt={class:"px-3 py-3"},nt={class:"px-6 py-3"},it={class:"flex items-center justify-between gap-2"},ut=["onClick"],ct={components:{SortIcon:{props:{active:Boolean,direction:String},template:`
                <span class="inline-block ml-2 text-xs">
                    <template v-if="active">
                        {{ direction === 'asc' ? 'â–²' : 'â–¼' }}
                    </template>
                    <template v-else>
                        â‡…
                    </template>
                </span>
            `}}},Pt=Object.assign(ct,{layout:ie},{__name:"Index",props:{purchaseOrders:{type:Object,required:!0},employees:{type:Array,required:!0},filters:{type:Object,default:()=>({})},sortBy:{type:String,default:"ordered_at"},sortDirection:{type:String,default:"desc"},groupBy:{type:String,default:null},canUpdate:{type:Boolean,default:!1},canView:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canCreate:{type:Boolean,default:!1}},setup(s){const W=[{label:"Penyimpanan"},{label:"Pembelian Barang"}],n=s,o=k({q:n.filters.q??"",employee_id:n.filters.employee_id??null,status_invoice:n.filters.status_invoice??"belum_lunas",status_delivered:n.filters.status_delivered??null,date_from:n.filters.date_from??"",date_to:n.filters.date_to??""}),b=k(n.groupBy??"all");w(b,()=>{te()});const h=P(()=>b.value||(n.groupBy??"all")),I=P(()=>!!h.value),O=k(!1),_=k(null),G=P(()=>{const r={},t=((n.purchaseOrders.current_page||1)-1)*(n.purchaseOrders.per_page||20);return(n.purchaseOrders.data||[]).forEach((a,y)=>{r[a.id]=t+y+1}),r}),q=k(new Set),Q=P(()=>{if(!I.value)return{};const r=n.purchaseOrders.data||[],t={};for(const c of r){const a=X(c);t[a]||(t[a]=[]),t[a].push(c)}return t});function X(r){switch(h.value){case"vendor":return r.vendor??"Tanpa Pemesan";case"ordered_by":return r.ordered_by??"Tanpa Pemesan";case"ordered_at":return r.ordered_at??"-";default:return"ungrouped"}}function Z(r){switch(h.value){case"vendor":return`Vendor oleh: ${r}`;case"ordered_by":return`Diminta oleh: ${r}`;case"ordered_at":return`Tanggal: ${r}`;default:return r}}function N(r){return q.value.has(r)}function ee(r){const t=new Set(q.value);t.has(r)?t.delete(r):t.add(r),q.value=t}function m({sortBy:r=n.sortBy,sortDirection:t=n.sortDirection,page:c=null,perPage:a=null}={}){const y={...o.value,groupBy:h.value||null,sortBy:r,sortDirection:t};c!==null&&(y.page=c),a!==null&&(y.per_page=a),R.get(route("purchase-orders.index"),y,{preserveScroll:!0,preserveState:!0,replace:!0,onStart:()=>{typeof window<"u"&&(window.__suppressProgress=!0)},onFinish:()=>{typeof window<"u"&&(window.__suppressProgress=!1)}})}let j;w(()=>o.value.q,()=>{clearTimeout(j),j=setTimeout(()=>m({}),400)}),w(()=>[o.value.employee_id,o.value.status_invoice??"belum_lunas",o.value.status_delivered,o.value.date_from,o.value.date_to],()=>{m({})}),w(b,()=>{m({})}),w(()=>n.groupBy,r=>{!b.value&&r&&(b.value=r)});function f(r){const t=n.sortBy===r&&n.sortDirection==="asc"?"desc":"asc";m({sortBy:r,sortDirection:t})}function te(){o.value={q:"",employee_id:null,status_invoice:"belum_lunas",status_delivered:null,date_from:"",date_to:""},m({})}function re(){o.value={q:"",employee_id:null,status_invoice:"belum_lunas",status_delivered:null,date_from:"",date_to:""},b.value="",m({})}function E(r){r?.id&&(_.value=r,O.value=!0)}function F(){O.value=!1,_.value=null}function ae(){_.value?.id&&R.delete(route("purchase-orders.destroy",_.value.id),{preserveScroll:!0,onSuccess:()=>{F(),m({})}})}function se(r){m({page:r})}function oe(r){m({perPage:r})}function M(r){return{belum_dibayar:"Belum Dibayar",lunas:"Lunas",belum_lunas:"Belum Lunas"}[r]??"Belum Dibayar"}function A(r){return{delivered:"Diterima",partial:"Diterima Sebagian",pending:"Belum Diterima"}[r]??r}function H(r){return{belum_dibayar:"bg-gray-100 text-gray-800",lunas:"bg-green-100 text-green-800",belum_lunas:"bg-yellow-100 text-yellow-800"}[r]??"bg-gray-100 text-gray-800"}function z(r){return{delivered:"bg-emerald-100 text-emerald-800",partial:"bg-amber-100 text-amber-800",pending:"bg-gray-100 text-gray-800"}[r]??"bg-gray-100 text-gray-700"}return(r,t)=>{const c=le("SortIcon");return u(),g(S,null,[d(x(de),{title:"Pembelian Barang"}),e("div",pe,[e("div",me,[d(ue,{items:W}),s.canCreate?(u(),B(x(D),{key:0,href:r.route("purchase-orders.create"),class:"inline-flex items-center gap-2 rounded-md border hover:border-gray-300 bg-blue-500 px-3 py-2 text-sm font-medium text-white hover:text-blue-500 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] dark:hover:text-gray-200"},{default:C(()=>[d(ge),t[14]||(t[14]=e("span",{class:"hidden md:block"},"Buat Pembelian",-1))]),_:1},8,["href"])):p("",!0)]),e("div",be,[e("div",fe,[t[16]||(t[16]=e("div",{class:"font-bold text-gray-700 md:text-xl dark:text-gray-300"}," Daftar Pembelian Barang ",-1)),e("div",xe,[e("div",null,[V(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>b.value=a),class:"h-10 px-3 text-sm text-gray-800 bg-transparent border border-gray-200 rounded-lg dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},[...t[15]||(t[15]=[e("option",{value:"all"},"Kelompokan Berdasarkan",-1),e("option",{value:"vendor"},"Group: Vendor",-1),e("option",{value:"ordered_by"}," Group: Dibuat oleh ",-1),e("option",{value:"ordered_at"},"Group: Tanggal",-1)])],512),[[ne,b.value]])])])]),e("div",ve,[e("table",he,[t[29]||(t[29]=e("colgroup",null,[e("col",{style:{width:"30px"}}),e("col",{style:{width:"160px"}}),e("col",{style:{width:"200px"}}),e("col",{style:{width:"220px"}}),e("col",{style:{width:"160px"}}),e("col",{style:{width:"140px"}}),e("col",{style:{width:"140px"}}),e("col",{style:{width:"150px"}})],-1)),e("thead",null,[e("tr",null,[t[23]||(t[23]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," No. ")],-1)),e("th",_e,[e("button",{onClick:t[1]||(t[1]=a=>f("order_no")),class:"px-3 font-medium text-gray-600 dark:text-gray-300"},[t[17]||(t[17]=v(" No. Pemesanan ",-1)),d(c,{active:s.sortBy==="order_no",direction:s.sortDirection},null,8,["active","direction"])])]),e("th",ke,[e("button",{onClick:t[2]||(t[2]=a=>f("request_no")),class:"px-3 font-medium text-gray-600 whitespace-nowrap dark:text-gray-300"},[t[18]||(t[18]=v(" No. Referensi (PR) ",-1)),d(c,{active:s.sortBy==="request_no",direction:s.sortDirection},null,8,["active","direction"])])]),e("th",we,[e("button",{onClick:t[3]||(t[3]=a=>f("vendor")),class:"w-full px-3 font-medium text-gray-600 dark:text-gray-300"},[t[19]||(t[19]=v(" Vendor ",-1)),d(c,{active:s.sortBy==="vendor",direction:s.sortDirection},null,8,["active","direction"])])]),e("th",Be,[e("button",{onClick:t[4]||(t[4]=a=>f("status_invoice")),class:"w-full px-3 font-medium text-left text-gray-600 dark:text-gray-300"},[t[20]||(t[20]=v(" Status Pembayaran ",-1)),d(c,{active:s.sortBy==="status_invoice",direction:s.sortDirection},null,8,["active","direction"])])]),e("th",Ce,[e("button",{onClick:t[5]||(t[5]=a=>f("status_delivered")),class:"w-full px-3 font-medium text-left text-gray-600 dark:text-gray-300"}," Status Pengiriman ")]),e("th",De,[e("button",{onClick:t[6]||(t[6]=a=>f("ordered_by")),class:"w-full px-3 font-medium text-left text-gray-600 dark:text-gray-300 whitespace-nowrap"},[t[21]||(t[21]=v(" Dibuat oleh ",-1)),d(c,{active:s.sortBy==="ordered_by",direction:s.sortDirection},null,8,["active","direction"])])]),e("th",Se,[e("button",{onClick:t[7]||(t[7]=a=>f("ordered_at")),class:"w-full px-3 font-medium text-left text-gray-600 dark:text-gray-300"},[t[22]||(t[22]=v(" Tanggal Pesan ",-1)),d(c,{active:s.sortBy==="ordered_at",direction:s.sortDirection},null,8,["active","direction"])])]),t[24]||(t[24]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," Cabang ")],-1)),t[25]||(t[25]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," Aksi ")],-1))]),e("tr",null,[e("th",Pe,[e("div",Ve,[V(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>o.value.q=a),type:"text",placeholder:"Cari nomor request / nama pemohon",class:"rounded-lg border border-gray-200 bg-transparent py-2.5 pl-4 pr-32 text-sm text-gray-800 focus:border-blue-300 focus:outline-hidden focus:ring-2 focus:ring-blue-500/20"},null,512),[[T,o.value.q]]),t[26]||(t[26]=e("span",{class:"absolute text-gray-400 -translate-y-1/2 right-36 top-1/2"},"ðŸ”",-1))])]),e("th",$e,[d(L,{modelValue:o.value.status_invoice,"onUpdate:modelValue":t[9]||(t[9]=a=>o.value.status_invoice=a),items:[{id:null,name:"Semua Status"},{id:"lunas",name:"Lunas"},{id:"belum_lunas",name:"Belum Lunas"}],label:"Pilih Status",class:"w-full text-xs sm:text-sm"},null,8,["modelValue"])]),e("th",Oe,[d(L,{modelValue:o.value.status_delivered,"onUpdate:modelValue":t[10]||(t[10]=a=>o.value.status_delivered=a),items:[{id:null,name:"Semua Status"},{id:"delivered",name:"Diterima"},{id:"partial",name:"Diterima Sebagian"},{id:"pending",name:"Belum Diterima"}],label:"Pilih Status Pengiriman",class:"w-full text-xs sm:text-sm"},null,8,["modelValue"])]),e("th",qe,[d(L,{modelValue:o.value.employee_id,"onUpdate:modelValue":t[11]||(t[11]=a=>o.value.employee_id=a),items:[{id:null,name:"Semua"},...s.employees],label:"Pilih Pemohon",class:"w-full text-xs sm:text-sm"},null,8,["modelValue","items"])]),e("th",Te,[e("div",Ue,[V(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>o.value.date_from=a),type:"date",class:"w-full h-10 px-2 text-xs border-gray-300 rounded sm:text-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},null,512),[[T,o.value.date_from]]),V(e("input",{"onUpdate:modelValue":t[13]||(t[13]=a=>o.value.date_to=a),type:"date",class:"w-full h-10 px-2 text-xs border-gray-300 rounded sm:text-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},null,512),[[T,o.value.date_to]])])]),t[27]||(t[27]=e("th",{class:"px-2 py-2 border-gray-200 bg-gray-50 border-y dark:border-gray-600 dark:bg-gray-900"},null,-1)),e("th",{class:"px-2 py-2 border-gray-200 bg-gray-50 border-y dark:border-gray-600 dark:bg-gray-900"},[e("button",{onClick:re,class:"px-3 py-2 text-xs text-white bg-red-500 rounded hover:bg-red-600"}," Clear ")])])]),e("tbody",null,[!s.purchaseOrders.data||s.purchaseOrders.data.length===0?(u(),g("tr",Le,[...t[28]||(t[28]=[e("td",{colspan:"9",class:"py-8 text-center text-gray-500"}," Tidak ada data pembelian. ",-1)])])):p("",!0),I.value?(u(!0),g(S,{key:1},U(Q.value,(a,y)=>(u(),g(S,{key:y},[h.value!=="all"?(u(),g("tr",Ie,[e("td",Ge,[e("button",{class:"inline-flex items-center gap-2",onClick:i=>ee(y)},[e("span",je,l(N(y)?"â–¶":"â–¼"),1),e("span",null,l(Z(y)),1),e("span",Ee,"("+l(a.length)+")",1)],8,Ne)])])):p("",!0),N(y)?p("",!0):(u(!0),g(S,{key:1},U(a,i=>(u(),g("tr",{key:i.id,class:"border-b border-gray-200 dark:border-gray-700"},[e("td",Fe,l(G.value[i.id]??"-")+". ",1),e("td",Me,l(i.order_no),1),e("td",Ae,l(i.pr_no??"-"),1),e("td",He,l(i.vendor),1),e("td",ze,[e("span",{class:$(`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${H(i.status_invoice)}`)},l(M(i.status_invoice)),3)]),e("td",Re,[e("span",{class:$(`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${z(i.status_delivered)}`)},l(A(i.status_delivered)),3)]),e("td",Ye,l(i.ordered_by),1),e("td",Je,l(i.ordered_at),1),e("td",Ke,l(i.branch??"-"),1),e("td",We,[e("div",Qe,[s.canView?(u(),B(x(D),{key:0,href:r.route("purchase-orders.show",i.id)},{default:C(()=>[d(Y,{class:"text-blue-400"})]),_:1},8,["href"])):p("",!0),s.canUpdate?(u(),B(x(D),{key:1,href:r.route("purchase-orders.edit",i.id)},{default:C(()=>[d(J,{class:"text-yellow-500"})]),_:1},8,["href"])):p("",!0),s.canDelete?(u(),g("button",{key:2,type:"button",onClick:yt=>E(i)},[d(K,{class:"text-red-500"})],8,Xe)):p("",!0)])])]))),128))],64))),128)):(u(!0),g(S,{key:2},U(s.purchaseOrders.data,a=>(u(),g("tr",{key:a.id,class:"border-b border-gray-200 dark:border-gray-700"},[e("td",Ze,l(G.value[a.id]??"-")+". ",1),e("td",et,l(a.order_no),1),e("td",tt,l(a.pr_no??"-"),1),e("td",rt,l(a.vendor),1),e("td",at,[e("span",{class:$(`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${H(a.status_invoice)}`)},l(M(a.status_invoice)),3)]),e("td",st,[e("span",{class:$(`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${z(a.status_delivered)}`)},l(A(a.status_delivered)),3)]),e("td",ot,l(a.ordered_by),1),e("td",lt,l(a.ordered_at),1),e("td",dt,l(a.branch??"-"),1),e("td",nt,[e("div",it,[s.canView?(u(),B(x(D),{key:0,href:r.route("purchase-orders.show",a.id)},{default:C(()=>[d(Y,{class:"text-blue-400"})]),_:1},8,["href"])):p("",!0),s.canUpdate?(u(),B(x(D),{key:1,href:r.route("purchase-orders.edit",a.id)},{default:C(()=>[d(J,{class:"text-yellow-500"})]),_:1},8,["href"])):p("",!0),s.canDelete?(u(),g("button",{key:2,type:"button",onClick:y=>E(a)},[d(K,{class:"text-red-500"})],8,ut)):p("",!0)])])]))),128))])]),d(ce,{pagination:s.purchaseOrders,onPageChange:se,onPerPageChange:oe,class:"border-t"},null,8,["pagination"])]),d(ye,{show:O.value,question:"Yakin ingin menghapus purchase order",selected:`${_.value?.order_no||"ini"}`,title:"Hapus Purchase Order",confirmText:"Ya, Hapus!",maxWidth:"md",onClose:F,onConfirm:ae},null,8,["show","selected"])])])],64)}}});export{Pt as default};
