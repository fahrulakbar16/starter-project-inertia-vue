import{d as m,e as n,o as l,b as p,a as e,g as a,D as G,f as d,F as k,i as j,t as o,h as P,E as T,G as D,n as $,H as x}from"./app-CJkCV51W.js";import{_ as H}from"./Breadcrumb-BJQpsGcc.js";import{_ as Q}from"./AppLayout-BlEKf3Fz.js";import{_ as h}from"./ConfirmModal-DAlWp-FQ.js";import"./FlashMessage-D4C-FUm8.js";import"./LayoutShell-FWpWJLvi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-DvuTgkfF.js";import"./LayoutShell.vue_vue_type_style_index_0_lang-CRqqKi3W.js";const X={class:"flex overflow-hidden flex-col gap-3 px-3 h-full"},Z={class:"flex justify-between items-center h-10"},ee={key:0,class:"flex fixed inset-0 z-50 justify-center items-center bg-black/40"},te={class:"w-[700px] max-w-[95vw] rounded-lg bg-white shadow"},se={class:"p-4 overflow-auto max-h-[70vh]"},ae={class:"min-w-full text-sm"},re={class:"p-2"},oe={class:"p-2 font-mono"},ne={class:"p-2"},le={class:"px-1"},ie={class:"p-2"},de=["onUpdate:modelValue"],ue={class:"px-1"},me={class:"p-2"},ce=["onUpdate:modelValue"],pe={class:"flex gap-2 justify-end px-4 py-3 border-t"},xe={class:"flex flex-col gap-4 overflow-hidden rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-600 dark:bg-white/[0.03]"},ge={class:"flex justify-between items-center"},ye={class:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4"},be={class:"font-semibold text-gray-800 dark:text-gray-200"},ve={class:"font-semibold text-gray-800 dark:text-gray-200"},fe={class:"font-semibold text-gray-800 dark:text-gray-200"},_e={class:"font-semibold text-gray-800 dark:text-gray-200"},ke={key:0},he={class:"font-semibold text-gray-800 dark:text-gray-200"},we={key:1},qe={class:"font-semibold text-gray-800 dark:text-gray-200"},Ce={class:"md:col-span-2 xl:col-span-3"},je={class:"font-semibold text-gray-800 whitespace-pre-line dark:text-gray-200"},Pe={class:"flex flex-col overflow-hidden rounded-lg border border-gray-200 bg-white dark:border-gray-600 dark:bg-white/[0.03]"},$e={class:"flex gap-2 items-center px-4 border-b border-gray-200 dark:border-gray-700"},Be={key:0,class:"overflow-auto","data-simplebar":""},Te={class:"min-w-full text-sm table-fixed"},De={key:0},Se={class:"px-3 py-2 text-center"},Re={class:"px-3 py-2"},Ie={class:"px-3 py-2 font-mono"},Ne={class:"px-3 py-2"},Ve={class:"px-2"},Fe={class:"px-3 py-2"},Ae={class:"px-2"},Ke={class:"px-3 py-2"},We={key:1,class:"p-6"},Ye={key:0,class:"text-sm text-gray-500"},Je={key:1,class:"space-y-3"},Ue={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},Le={class:"text-xs text-gray-500"},Me={class:"text-sm text-gray-700 dark:text-gray-300"},ze={key:1,class:"flex gap-4 justify-end items-center"},Ee={key:2,class:"flex gap-2 justify-end items-center"},Oe={key:3,class:"flex gap-2 justify-end items-center"},rt=Object.assign({layout:Q},{__name:"Show",props:{mr:{type:Object,required:!0},items:{type:Array,default:()=>[]},activities:{type:Array,default:()=>[]},can_approve:{type:Boolean,default:!1}},setup(S){const g=S,r=g.mr,y=g.items,w=g.activities,B=g.can_approve;console.log("mr status:",r.status);const R=[{label:"Penyimpanan"},{label:"Permintaan Barang",href:route("material-requests.index")},{label:r.request_no}],c=m("items"),b=m(!1),q=m([]),v=m(!1),f=m(!1),_=m(!1),C=m(!1);function I(i){return{pending:"Menunggu Persetujuan",approved:"Disetujui",rejected:"Ditolak",canceled:"Dibatalkan",partial_approved:"Disetujui Sebagian"}[i]??i}function N(i){return{pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-500/20 dark:text-yellow-300",approved:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300",rejected:"bg-rose-100 text-rose-800 dark:bg-rose-500/20 dark:text-rose-300",canceled:"bg-slate-100 text-slate-700 dark:bg-slate-500/20 dark:text-slate-300",partial_approved:"bg-violet-100 text-violet-800 dark:bg-violet-500/20 dark:text-violet-300"}[i]??"bg-gray-100 text-gray-700"}function V(){v.value=!0}function F(){v.value=!1}function A(){q.value=(y||[]).map(i=>({id:i.id,item_name:i.item_name,item_code:i.item_code,unit:i.unit,quantity_requested:i.quantity_requested,quantity_approved:i.quantity_approved??i.quantity_requested,note:i.note||""})),b.value=!0}function K(){x.post(route("material-requests.approve",r.id),{approvals:q.value},{preserveScroll:!0,onFinish:()=>{b.value=!1}})}function W(){x.post(route("material-requests.rejected",r.id),{},{preserveScroll:!0,onFinish:()=>{v.value=!1}})}function Y(){f.value=!0}function J(){f.value=!1}function U(){x.post(route("material-requests.cancel",r.id),{},{preserveScroll:!0,onFinish:()=>{f.value=!1}})}function L(){_.value=!0}function M(){_.value=!1}function z(){x.post(route("purchase-requests.from-material-request",r.id),{},{preserveScroll:!0,onFinish:()=>{_.value=!1}})}function E(){C.value=!1}function O(){x.post(route("material-requests.issue",r.id),{},{preserveScroll:!0,onFinish:()=>{C.value=!1}})}return(i,t)=>(l(),n(k,null,[p(a(G),{title:`Permintaan Barang ${a(r).request_no}`},null,8,["title"]),e("div",X,[e("div",Z,[p(H,{items:R})]),b.value?(l(),n("div",ee,[e("div",te,[t[7]||(t[7]=e("div",{class:"px-4 py-3 border-b"},[e("div",{class:"font-semibold"}," Setujui Permintaan - Masukkan Qty Disetujui ")],-1)),e("div",se,[e("table",ae,[t[6]||(t[6]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"p-2 text-left"},"Nama Item"),e("th",{class:"p-2 text-left"},"Kode"),e("th",{class:"p-2 text-left"}," Jumlah yang dibutuhkan "),e("th",{class:"p-2 text-left"}," Jumlah yang disetujui "),e("th",{class:"p-2 text-left"},"Catatan")])],-1)),e("tbody",null,[(l(!0),n(k,null,j(q.value,s=>(l(),n("tr",{key:s.id,class:"border-b"},[e("td",re,o(s.item_name),1),e("td",oe,o(s.item_code),1),e("td",ne,[P(o(s.quantity_requested)+" ",1),e("span",le,o(s.unit),1)]),e("td",ie,[T(e("input",{type:"number",min:"0",class:"px-2 w-28 h-9 rounded border","onUpdate:modelValue":u=>s.quantity_approved=u},null,8,de),[[D,s.quantity_approved,void 0,{number:!0}]]),e("span",ue,o(s.unit),1)]),e("td",me,[T(e("input",{type:"text",class:"px-2 w-full h-9 rounded border","onUpdate:modelValue":u=>s.note=u,placeholder:"Catatan (opsional)"},null,8,ce),[[D,s.note]])])]))),128))])])]),e("div",pe,[e("button",{onClick:t[0]||(t[0]=s=>b.value=!1),class:"px-3 h-9 rounded border"}," Batal "),e("button",{onClick:K,class:"px-3 h-9 text-white bg-emerald-600 rounded"}," Simpan & Setujui ")])])])):d("",!0),e("div",xe,[e("div",ge,[t[8]||(t[8]=e("div",{class:"font-bold text-gray-700 md:text-xl dark:text-gray-300"}," Informasi Permintaan Barang ",-1)),e("div",null,[e("span",{class:$([N(a(r).status),"px-2.5 py-1 text-xs font-medium rounded-full"])},o(I(a(r).status)),3)])]),e("div",ye,[e("div",null,[t[9]||(t[9]=e("div",{class:"text-xs text-gray-500"},"No. Request",-1)),e("div",be,o(a(r).request_no),1)]),e("div",null,[t[10]||(t[10]=e("div",{class:"text-xs text-gray-500"},"Departemen",-1)),e("div",ve,o(a(r).department),1)]),e("div",null,[t[11]||(t[11]=e("div",{class:"text-xs text-gray-500"},"Diminta oleh",-1)),e("div",fe,o(a(r).requested_by),1)]),e("div",null,[t[12]||(t[12]=e("div",{class:"text-xs text-gray-500"},"Tanggal Permintaan",-1)),e("div",_e,o(a(r).requested_at),1)]),a(r).approved_by?(l(),n("div",ke,[t[13]||(t[13]=e("div",{class:"text-xs text-gray-500"},"Disetujui oleh",-1)),e("div",he,o(a(r).approved_by),1)])):d("",!0),a(r).approved_at?(l(),n("div",we,[t[14]||(t[14]=e("div",{class:"text-xs text-gray-500"},"Waktu Persetujuan",-1)),e("div",qe,o(a(r).approved_at),1)])):d("",!0),e("div",Ce,[t[15]||(t[15]=e("div",{class:"text-xs text-gray-500"},"Catatan",-1)),e("div",je,o(a(r).requirement||"-"),1)])])]),e("div",Pe,[e("div",$e,[e("button",{class:$(["px-4 py-3 text-sm font-medium",c.value==="items"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 dark:text-gray-300"]),onClick:t[1]||(t[1]=s=>c.value="items")}," Daftar Item ",2),e("button",{class:$(["px-4 py-3 text-sm font-medium",c.value==="activities"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 dark:text-gray-300"]),onClick:t[2]||(t[2]=s=>c.value="activities")}," Aktivitas Log ",2)]),c.value==="items"?(l(),n("div",Be,[e("table",Te,[t[17]||(t[17]=e("thead",null,[e("tr",null,[e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-2 font-medium text-gray-600 dark:text-gray-300"}," No. ")]),e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-left text-gray-600 dark:text-gray-300"}," Nama Item ")]),e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-left text-gray-600 dark:text-gray-300"}," Kode Item ")]),e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-left text-gray-600 dark:text-gray-300"}," Jumlah yang dibutuhkan ")]),e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-left text-gray-600 dark:text-gray-300"}," Jumlah yang disetujui ")]),e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-left text-gray-600 dark:text-gray-300"}," Catatan ")])])],-1)),e("tbody",null,[!a(y)||a(y).length===0?(l(),n("tr",De,[...t[16]||(t[16]=[e("td",{colspan:"6",class:"py-8 text-center text-gray-500"}," Tidak ada item ",-1)])])):d("",!0),(l(!0),n(k,null,j(a(y),(s,u)=>(l(),n("tr",{key:s.id,class:"border-b border-gray-200 dark:border-gray-700"},[e("td",Se,o(u+1)+". ",1),e("td",Re,o(s.item_name),1),e("td",Ie,o(s.item_code),1),e("td",Ne,[P(o(s.quantity_requested)+" ",1),e("span",Ve,o(s.unit),1)]),e("td",Fe,[P(o(s.quantity_approved)+" ",1),e("span",Ae,o(s.unit),1)]),e("td",Ke,o(s.note),1)]))),128))])])])):d("",!0),c.value==="activities"?(l(),n("div",We,[!a(w)||a(w).length===0?(l(),n("div",Ye," Belum ada aktivitas. ")):(l(),n("ul",Je,[(l(!0),n(k,null,j(a(w),(s,u)=>(l(),n("li",{key:u,class:"flex gap-3 items-start"},[t[18]||(t[18]=e("div",{class:"mt-1 w-2 h-2 bg-blue-500 rounded-full"},null,-1)),e("div",null,[e("div",Ue,o(s.title),1),e("div",Le,o(s.time),1),e("div",Me,o(s.description),1)])]))),128))]))])):d("",!0)]),a(r).status==="approved"?(l(),n("div",ze,[e("button",{onClick:t[3]||(t[3]=s=>L()),class:"inline-flex items-center px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded hover:bg-indigo-700"}," Kirim ke Pengajuan Pembelian ")])):a(r).status==="pending"?(l(),n("div",Ee,[a(B)?(l(),n("button",{key:0,onClick:t[4]||(t[4]=s=>A()),class:"inline-flex items-center px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded hover:bg-indigo-700"}," Setujui ")):d("",!0),a(B)?(l(),n("button",{key:1,onClick:t[5]||(t[5]=s=>V()),class:"inline-flex items-center px-3 py-2 text-sm font-medium text-white bg-red-600 rounded hover:bg-red-700"}," Tolak ")):d("",!0),e("button",{onClick:Y,class:"inline-flex items-center px-3 py-2 text-sm font-medium text-white bg-yellow-500 rounded hover:bg-yellow-700"}," Batalkan ")])):(l(),n("div",Oe))]),p(h,{show:f.value,question:"Yakin ingin membatalkan permintaan ini?",selected:`${a(r).request_no}`,title:"Batalkan Permintaan",confirmText:"Ya, Batalkan!",maxWidth:"md",onClose:J,onConfirm:U},null,8,["show","selected"]),p(h,{show:_.value,question:`Buat Pengajuan Pembelian dari ${a(r).request_no}?`,selected:`${a(r).request_no}`,title:"Proses ke Pengajuan Pembelian",confirmText:"Ya, Buat Pengajuan",maxWidth:"md",onClose:M,onConfirm:z},null,8,["show","question","selected"]),p(h,{show:C.value,question:`Keluarkan barang berdasarkan ${a(r).request_no}?`,selected:`${a(r).request_no}`,title:"Kirim ke Pemakaian Barang",confirmText:"Ya, Keluarkan",maxWidth:"md",onClose:E,onConfirm:O},null,8,["show","question","selected"]),p(h,{show:v.value,question:"Tolak permintaan ini?",selected:`${a(r).request_no}`,title:"Tolak Permintaan",confirmText:"Ya, Tolak",maxWidth:"md",onClose:F,onConfirm:W},null,8,["show","selected"])],64))}});export{rt as default};
