import{d as g,e as r,o as s,a as e,c as k,f as w,b as _,F as c,i as x,t as m,w as I,g as z,h as $,H as S}from"./app-CJkCV51W.js";import{_ as F}from"./Pagination-C2dOEo8X.js";import{_ as H}from"./Modal-Ddbg9qvg.js";import{_ as P}from"./AvatarInitials-XMdLKKbn.js";import{_ as T}from"./ConfirmModal-DAlWp-FQ.js";import{u as G}from"./useAuth-DvuTgkfF.js";const K={class:"overflow-auto","data-simplebar":""},A={class:"min-w-full text-sm"},E={class:"font-medium text-center text-gray-600"},J={class:"p-3 text-center"},O={class:"p-3"},U={class:"flex gap-3 items-center"},W=["src"],Y={class:"flex flex-col"},q={class:"font-medium text-gray-800"},L={class:"text-xs text-gray-500"},Q={class:"flex justify-center"},R=["onClick"],X={key:1,class:"inline-flex justify-center items-center w-6 h-6 text-gray-400 bg-gray-100 rounded-full"},Z={key:1},ee={class:"space-y-4"},te={class:"flex justify-between items-center p-4 bg-gray-50 rounded-lg"},le={class:"flex items-center space-x-2"},ae={class:"relative w-full h-[600px] bg-gray-100 rounded-lg overflow-hidden"},se=["src"],oe={key:1,class:"flex justify-center items-center h-full text-gray-500"},me={__name:"SalaryTab",props:{rows:Object,year:Number},setup(n){const{can:j}=G(),u=n,p=g(!1),a=g({title:"",url:"",employeeId:null,month:null,employeeName:null}),y=g(!1);function C(i,t,l){const o=u.year,d=`${o}-${String(t).padStart(2,"0")}`,b=v(t);a.value={title:`Slip Gaji - ${l} (${b} ${o})`,url:"",employeeId:i,month:t,employeeName:l},p.value=!0;const B=route("salary-slips.preview",{employee_id:i,bulan:d});setTimeout(()=>{a.value.url=B},100)}function N(){if(a.value.employeeId&&a.value.month){const t=`${u.year}-${String(a.value.month).padStart(2,"0")}`,l=route("salary-slips.download",{employee_id:a.value.employeeId,bulan:t}),o=document.createElement("a");o.href=l,o.download=`salary-slip-${a.value.employeeId}-${t}.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o)}}function h(){p.value=!1,a.value={title:"",url:"",employeeId:null,month:null,employeeName:null}}function M(){!a.value.employeeId||!a.value.month||(y.value=!0)}function f(){y.value=!1}function D(){if(!a.value.employeeName||!a.value.month)return"";const i=u.year,t=v(a.value.month);return`${a.value.employeeName} (${t} ${i})`}function V(){if(!a.value.employeeId||!a.value.month){f();return}const t=`${u.year}-${String(a.value.month).padStart(2,"0")}`,l=route("salary-slips.destroy")+`?employee_id=${a.value.employeeId}&bulan=${t}`;S.delete(l,{onSuccess:()=>{f(),h(),S.reload({only:["rows"]})},onError:o=>{alert(o?.message||"Gagal menghapus slip gaji.")},preserveScroll:!0})}function v(i){return["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"][i-1]||`Bulan ${i}`}return(i,t)=>(s(),r(c,null,[e("div",K,[e("table",A,[e("thead",null,[e("tr",null,[t[0]||(t[0]=e("th",{class:"p-3 bg-gray-100 border-gray-200 border-y"},[e("div",{class:"font-medium text-center text-gray-600"}," No ")],-1)),t[1]||(t[1]=e("th",{class:"p-3 bg-gray-100 border border-gray-200"},[e("div",{class:"font-medium text-left text-gray-600"}," Nama Karyawan ")],-1)),(s(),r(c,null,x(12,l=>e("th",{key:l,class:"p-3 bg-gray-100 border border-gray-200"},[e("div",E,m(l),1)])),64))])]),e("tbody",null,[n.rows&&n.rows.data&&n.rows.data.length?(s(!0),r(c,{key:0},x(n.rows.data,(l,o)=>(s(),r("tr",{key:l.id,class:"border-b border-gray-200"},[e("td",J,m((n.rows.current_page-1)*n.rows.per_page+o+1),1),e("td",O,[e("div",U,[l.employee.photo_url?(s(),r("img",{key:0,src:l.employee.photo_url?`/storage/${l.employee.photo_url}`:"",alt:"avatar",class:"object-cover w-8 h-8 rounded-full"},null,8,W)):(s(),k(P,{key:1,name:l.employee.name,gender:l.employee.gender||"",size:32},null,8,["name","gender"])),e("div",Y,[e("span",q,m(l.employee.name),1),e("span",L,m(l.employee.role||"Staff"),1)])])]),(s(),r(c,null,x(12,d=>e("td",{key:d,class:"p-3 text-center"},[e("div",Q,[l.salary_slips&&l.salary_slips[d]===!0?(s(),r("button",{key:0,onClick:b=>C(l.employee.id,d,l.employee.name),class:"inline-flex justify-center items-center w-6 h-6 text-green-600 bg-green-100 rounded-full transition-colors cursor-pointer hover:bg-green-200",title:"Klik untuk preview slip gaji"}," âœ“ ",8,R)):(s(),r("span",X," - "))])])),64))]))),128)):(s(),r("tr",Z,[...t[2]||(t[2]=[e("td",{colspan:14,class:"py-6 text-center text-gray-500"}," Tidak ada data ",-1)])]))])])]),n.rows&&n.rows.data&&n.rows.data.length?(s(),k(F,{key:0,pagination:n.rows,class:"border-t"},null,8,["pagination"])):w("",!0),_(H,{show:p.value,title:a.value.title,maxWidth:"2xl",onClose:h},{default:I(()=>[e("div",ee,[e("div",te,[t[3]||(t[3]=e("div",{class:"flex items-center space-x-3"},[e("div",{class:"flex justify-center items-center w-10 h-10 bg-blue-100 rounded-full"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])]),e("div",null,[e("h3",{class:"text-sm font-medium text-gray-900"}," Slip Gaji PDF "),e("p",{class:"text-xs text-gray-500"}," Dokumen dapat di-scroll dan di-zoom ")])],-1)),e("div",le,[e("button",{onClick:N,class:"px-3 py-1.5 text-xs text-blue-600 bg-blue-50 rounded-md transition-colors hover:bg-blue-100"}," Download "),z(j)("attendance_recap.delete_salary_slip")?(s(),r("button",{key:0,onClick:M,class:"px-3 py-1.5 text-xs text-red-600 bg-red-50 rounded-md transition-colors hover:bg-red-100"}," Hapus ")):w("",!0)])]),e("div",ae,[a.value.url?(s(),r("iframe",{key:0,src:a.value.url,class:"w-full h-full border-0",type:"application/pdf",frameborder:"0"},null,8,se)):(s(),r("div",oe,[...t[4]||(t[4]=[e("div",{class:"text-center"},[e("div",{class:"mx-auto mb-4 w-12 h-12 rounded-full border-b-2 border-blue-600 animate-spin"}),e("p",{class:"text-sm font-medium"},"Memuat dokumen PDF..."),e("p",{class:"mt-1 text-xs text-gray-400"}," Mohon tunggu sebentar ")],-1)])]))]),t[5]||(t[5]=e("div",{class:"flex justify-between items-center p-3 bg-gray-50 rounded-lg"},[e("div",{class:"flex items-center space-x-4 text-xs text-gray-500"},[e("span",{class:"flex items-center"},[e("svg",{class:"mr-1 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),$(" Scroll untuk melihat halaman ")]),e("span",{class:"flex items-center"},[e("svg",{class:"mr-1 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})]),$(" Gunakan zoom untuk memperbesar ")])]),e("div",{class:"text-xs text-gray-400"},"PDF Viewer")],-1))])]),_:1},8,["show","title"]),_(T,{show:y.value,question:"Yakin ingin menghapus slip gaji",selected:D(),title:"Hapus Slip Gaji",confirmText:"Ya, Hapus!",maxWidth:"md",onClose:f,onConfirm:V},null,8,["show","selected"])],64))}};export{me as default};
