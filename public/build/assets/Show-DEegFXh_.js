import{d as m,e as s,o,b as h,a as t,f as n,g as d,D as P,h as A,n as k,t as a,F as p,i as f,K as S,E as w,G as q,H as j}from"./app-CJkCV51W.js";import{_ as I}from"./Breadcrumb-BJQpsGcc.js";import{_ as T}from"./AppLayout-BlEKf3Fz.js";import"./FlashMessage-D4C-FUm8.js";import"./LayoutShell-FWpWJLvi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-DvuTgkfF.js";import"./LayoutShell.vue_vue_type_style_index_0_lang-CRqqKi3W.js";const $={class:"flex overflow-hidden flex-col gap-3 px-3 h-full"},E={class:"flex justify-between items-center h-10"},L={class:"flex items-center gap-3"},U={class:"flex items-center gap-2"},K={class:"flex flex-col gap-4 overflow-hidden rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-600 dark:bg-white/[0.03]"},O={class:"flex items-center justify-between"},Q={class:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-3"},z={class:"font-semibold text-gray-800 dark:text-gray-200"},F={class:"font-semibold text-gray-800 dark:text-gray-200"},H={class:"font-semibold text-gray-800 dark:text-gray-200"},G={class:"font-semibold text-gray-800 dark:text-gray-200"},R={key:0},W={class:"font-semibold text-gray-800 dark:text-gray-200"},J={key:1},X={class:"font-semibold text-gray-800 dark:text-gray-200"},Y={class:"md:col-span-2 xl:col-span-3"},Z={class:"font-semibold text-gray-800 dark:text-gray-200 whitespace-pre-line"},tt={class:"flex flex-col overflow-hidden rounded-lg border border-gray-200 bg-white dark:border-gray-600 dark:bg-white/[0.03]"},et={class:"flex items-center gap-2 px-4 border-b border-gray-200 dark:border-gray-700"},rt={key:0,class:"overflow-auto","data-simplebar":""},at={class:"min-w-full text-sm table-fixed"},st={key:0},ot={class:"px-3 py-2"},dt={class:"px-3 py-2"},lt={class:"px-3 py-2 font-mono"},it={class:"px-3 py-2"},nt={key:0,class:"text-orange-600 dark:text-orange-400"},yt={key:1},gt={class:"px-3 py-2"},ut={class:"px-3 py-2"},xt={key:0,class:"text-xs text-gray-500 italic"},pt={key:1,class:"p-6"},ct={key:0,class:"text-sm text-gray-500"},bt={key:1,class:"space-y-4"},vt={class:"flex-1"},mt={class:"flex items-center justify-between"},kt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ft={class:"text-xs text-gray-500"},_t={class:"mt-1 text-sm text-gray-700 dark:text-gray-300"},ht={class:"mt-1 text-xs text-gray-500"},wt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden flex flex-col"},qt={class:"overflow-y-auto flex-1 px-6 py-4"},jt={class:"min-w-full text-sm"},Ct={class:"py-3"},Dt={class:"font-medium text-gray-900 dark:text-white"},Bt={class:"text-xs text-gray-500"},Nt={class:"py-3 text-gray-700 dark:text-gray-300"},Vt={class:"py-3"},Mt=["onUpdate:modelValue","max"],Pt={class:"py-3"},At=["onUpdate:modelValue"],Ot=Object.assign({layout:T},{__name:"Show",props:{mr:{type:Object,required:!0},items:{type:Array,default:()=>[]},activities:{type:Array,default:()=>[]},can_approve:{type:Boolean,default:!1}},setup(_){const c=_,l=c.mr,g=m(c.items.map(i=>({...i,approval:{quantity_approved:i.quantity_approved??i.qty??"",note_received:i.note_received||""}}))),b=c.activities,C=[{label:"Dashboard",href:route("dashboard")},{label:"Pemakaian Barang",href:route("good-issues.index")},{label:l.request_no}],u=m("items");function D(i){return{pending:"Menunggu Persetujuan",draft:"Draft",submitted:"Dikirim",approved:"Disetujui",on_progress:"Dalam Proses",canceled:"Dibatalkan"}[i]??i}function B(i){return{pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-500/20 dark:text-yellow-300",draft:"bg-gray-100 text-gray-800 dark:bg-gray-500/20 dark:text-gray-300",submitted:"bg-blue-100 text-blue-800 dark:bg-blue-500/20 dark:text-blue-300",approved:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300",rejected:"bg-rose-100 text-rose-800 dark:bg-rose-500/20 dark:text-rose-300",on_progress:"bg-blue-100 text-blue-800 dark:bg-blue-500/20 dark:text-blue-300",canceled:"bg-slate-100 text-slate-700 dark:bg-slate-500/20 dark:text-slate-300",partial_approved:"bg-violet-100 text-violet-800 dark:bg-violet-500/20 dark:text-violet-300"}[i]??"bg-gray-100 text-gray-700"}const x=m(!1);function N(){l.status!=="approved"&&(x.value=!0)}function v(){x.value=!1}function V(){if(!g.value.every(r=>!(!r.approval||r.approval.quantity_approved===null||r.approval.quantity_approved===""))){alert("Harap isi jumlah yang disetujui untuk semua item");return}const e=g.value.map(r=>({id:r.id,quantity_approved:parseInt(r.approval.quantity_approved),note_received:r.approval.note_received||null}));j.post(route("good-issues.approve",l.id),{approvals:e},{onSuccess:()=>{window.location.reload(),x.value=!1},onError:r=>{console.error("Error approving pemakaian barang:",r)}})}function M(){j.get(route("good-issues.index"))}return(i,e)=>(o(),s(p,null,[h(d(P),{title:`Pemakaian Barang ${d(l).request_no}`},null,8,["title"]),t("div",$,[t("div",E,[t("div",L,[t("button",{onClick:M,class:"inline-flex items-center rounded border border-gray-300 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800"},[...e[2]||(e[2]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),A(" Kembali ",-1)])]),h(I,{items:C})]),t("div",U,[_.can_approve&&d(l).status==="pending"?(o(),s("button",{key:0,onClick:N,class:"inline-flex items-center rounded bg-emerald-600 px-3 py-2 text-sm font-medium text-white hover:bg-emerald-700"},"Setujui")):n("",!0)])]),t("div",K,[t("div",O,[e[3]||(e[3]=t("div",{class:"font-bold text-gray-700 md:text-xl dark:text-gray-300"},"Informasi Pemakaian Barang",-1)),t("div",null,[t("span",{class:k([B(d(l).status),"px-2.5 py-1 rounded-full text-xs font-medium"])},a(D(d(l).status)),3)])]),t("div",Q,[t("div",null,[e[4]||(e[4]=t("div",{class:"text-xs text-gray-500"},"No. Request",-1)),t("div",z,a(d(l).request_no),1)]),t("div",null,[e[5]||(e[5]=t("div",{class:"text-xs text-gray-500"},"Departemen",-1)),t("div",F,a(d(l).department),1)]),t("div",null,[e[6]||(e[6]=t("div",{class:"text-xs text-gray-500"},"Diminta oleh",-1)),t("div",H,a(d(l).requested_by),1)]),t("div",null,[e[7]||(e[7]=t("div",{class:"text-xs text-gray-500"},"Tanggal Pemakaian",-1)),t("div",G,a(d(l).request_date),1)]),d(l).approved_by?(o(),s("div",R,[e[8]||(e[8]=t("div",{class:"text-xs text-gray-500"},"Disetujui oleh",-1)),t("div",W,a(d(l).approved_by),1)])):n("",!0),d(l).approved_at?(o(),s("div",J,[e[9]||(e[9]=t("div",{class:"text-xs text-gray-500"},"Waktu Persetujuan",-1)),t("div",X,a(d(l).approved_at),1)])):n("",!0),t("div",Y,[e[10]||(e[10]=t("div",{class:"text-xs text-gray-500"},"Catatan",-1)),t("div",Z,a(d(l).notes||"-"),1)])])]),t("div",tt,[t("div",et,[t("button",{class:k(["px-4 py-3 text-sm font-medium",u.value==="items"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 dark:text-gray-300"]),onClick:e[0]||(e[0]=r=>u.value="items")}," Daftar Item ",2),t("button",{class:k(["px-4 py-3 text-sm font-medium",u.value==="activities"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 dark:text-gray-300"]),onClick:e[1]||(e[1]=r=>u.value="activities")}," Aktivitas Log ",2)]),u.value==="items"?(o(),s("div",rt,[t("table",at,[e[12]||(e[12]=t("colgroup",null,[t("col",{style:{width:"60px"}}),t("col",{style:{width:"220px"}}),t("col",{style:{width:"180px"}}),t("col",{style:{width:"120px"}}),t("col",{style:{width:"120px"}}),t("col")],-1)),e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[t("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"No")]),t("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[t("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Nama Item")]),t("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[t("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Kode")]),t("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[t("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Qty")]),t("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[t("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Satuan")]),t("th",{class:"py-2.5 bg-gray-100 border-y border-gray-200 dark:border-gray-600 dark:bg-gray-800"},[t("div",{class:"px-3 text-left font-medium text-gray-600 dark:text-gray-300"},"Catatan")])])],-1)),t("tbody",null,[!g.value||g.value.length===0?(o(),s("tr",st,[...e[11]||(e[11]=[t("td",{colspan:"6",class:"text-center py-8 text-gray-500"},"Tidak ada item",-1)])])):n("",!0),(o(!0),s(p,null,f(g.value,(r,y)=>(o(),s("tr",{key:r.id,class:"border-b border-gray-200 dark:border-gray-700"},[t("td",ot,a(y+1),1),t("td",dt,a(r.item_name),1),t("td",lt,a(r.item_code),1),t("td",it,[r.quantity_approved&&r.quantity_approved!==r.qty?(o(),s("span",nt,a(r.quantity_approved)+" / "+a(r.qty),1)):(o(),s("span",yt,a(r.qty),1))]),t("td",gt,a(r.unit),1),t("td",ut,[r.note_received?(o(),s("div",xt," Note: "+a(r.note_received),1)):n("",!0),t("div",null,a(r.notes),1)])]))),128))])])])):n("",!0),u.value==="activities"?(o(),s("div",pt,[!d(b)||d(b).length===0?(o(),s("div",ct,"Belum ada aktivitas.")):(o(),s("ul",bt,[(o(!0),s(p,null,f(d(b),(r,y)=>(o(),s("li",{key:y,class:"flex gap-4 items-start border-l-2 border-blue-500 pl-4"},[e[14]||(e[14]=t("div",{class:"flex-shrink-0 mt-0.5"},[t("div",{class:"h-2 w-2 rounded-full bg-blue-500"})],-1)),t("div",vt,[t("div",mt,[t("div",kt,a(r.title),1),t("div",ft,a(r.time),1)]),t("div",_t,a(r.description),1),t("div",ht,"Oleh: "+a(r.user),1)])]))),128))]))])):n("",!0)])]),x.value?(o(),s("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:S(v,["self"])},[t("div",wt,[t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("div",{class:"flex items-center justify-between"},[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Setujui Pemakaian Barang ",-1)),t("button",{onClick:v,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...e[15]||(e[15]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),t("div",qt,[t("table",jt,[e[17]||(e[17]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"py-2 text-left font-medium text-gray-700 dark:text-gray-300"},"Item"),t("th",{class:"py-2 text-left font-medium text-gray-700 dark:text-gray-300"},"Qty Diminta"),t("th",{class:"py-2 text-left font-medium text-gray-700 dark:text-gray-300"},"Qty Disetujui"),t("th",{class:"py-2 text-left font-medium text-gray-700 dark:text-gray-300"},"Note")])],-1)),t("tbody",null,[(o(!0),s(p,null,f(g.value,r=>(o(),s("tr",{key:r.id,class:"border-b border-gray-200 dark:border-gray-700"},[t("td",Ct,[t("div",Dt,a(r.item_name),1),t("div",Bt,a(r.item_code),1)]),t("td",Nt,a(r.qty),1),t("td",Vt,[w(t("input",{"onUpdate:modelValue":y=>r.approval.quantity_approved=y,type:"number",min:"0",max:r.qty,class:"w-20 rounded border-gray-300 dark:border-gray-700 dark:bg-gray-700 dark:text-white px-2 py-1 text-sm"},null,8,Mt),[[q,r.approval.quantity_approved]])]),t("td",Pt,[w(t("input",{"onUpdate:modelValue":y=>r.approval.note_received=y,type:"text",placeholder:"Note penerimaan",class:"w-full rounded border-gray-300 dark:border-gray-700 dark:bg-gray-700 dark:text-white px-2 py-1 text-sm"},null,8,At),[[q,r.approval.note_received]])])]))),128))])])]),t("div",{class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3"},[t("button",{onClick:v,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 dark:bg-gray-600 dark:text-gray-300 dark:border-gray-500 dark:hover:bg-gray-500"}," Batal "),t("button",{onClick:V,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700"}," Setujui ")])])])):n("",!0)],64))}});export{Ot as default};
