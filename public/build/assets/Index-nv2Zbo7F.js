import{y as B,d as f,z as F,H as w,u as G,e as r,o,b as y,a as e,g as n,D as I,f as d,c as N,E as _,G as v,F as A,i as J,t as u,w as D}from"./app-CJkCV51W.js";import{_ as K}from"./AppLayout-BlEKf3Fz.js";import{_ as R}from"./Breadcrumb-BJQpsGcc.js";import{_ as Y}from"./Pagination-C2dOEo8X.js";import{_ as z}from"./ConfirmModal-DAlWp-FQ.js";import{s as W}from"./index-D_jvqarE.js";import{u as Q}from"./useAuth-DvuTgkfF.js";import"./FlashMessage-D4C-FUm8.js";import"./LayoutShell-FWpWJLvi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./LayoutShell.vue_vue_type_style_index_0_lang-CRqqKi3W.js";import"./index-BD4Vkpl0.js";import"./index-B9o0VbjL.js";const X={class:"flex flex-col h-full gap-3 px-3 overflow-hidden"},Z={class:"flex items-center justify-between h-10"},ee={class:"flex gap-2"},te={class:"flex flex-col overflow-hidden bg-white border border-gray-200 rounded-lg"},se={class:"flex items-center justify-between px-6 py-3 border-b"},ne={class:"relative"},ae={class:"overflow-auto","data-simplebar":""},le={class:"min-w-full text-sm"},oe={key:0,class:"p-3 bg-gray-100 border-gray-200 border-y"},re={class:"p-3 text-center"},ie={class:"p-3"},de={class:"p-3"},ue=["src"],ce={key:1,class:"text-gray-400"},me={class:"p-3"},pe={class:"p-3 text-center"},ge={class:"p-3 text-center"},fe={key:0,class:"p-3"},be={class:"flex justify-center gap-2"},ye=["onClick"],xe=["onClick"],_e={key:1},ve=["colspan"],he={class:"flex items-center justify-between w-full"},ke={class:"text-xl font-semibold text-gray-900"},Ce={class:"flex flex-col gap-3"},we={key:0,class:"mt-1 text-xs text-red-600"},De={key:0,class:"mt-1 text-xs text-red-600"},Se={class:"flex items-center gap-3"},Ee={key:0,class:"mt-1 text-xs text-red-600"},je={key:1,class:"mt-2"},Me=["src"],Te={class:"flex justify-end gap-2"},Ue=["disabled"],$e={key:0},Pe={key:1},Re=Object.assign({layout:K},{__name:"Index",props:{announcements:Object,q:String},setup(S){const{can:i}=Q(),h=S,c=B(()=>h.announcements||{data:[]}),b=f(h.q||"");let k=null;F(b,()=>{clearTimeout(k),k=setTimeout(()=>E(),350)});function E(){w.get(route("announcements.index"),{q:b.value},{preserveScroll:!0,preserveState:!0,replace:!0})}const p=f(!1),s=G({id:null,title:"",content:"",img_file:null,created_by:null}),m=f("");function j(){i("announcements.create")&&(s.defaults({id:null,title:"",content:"",created_by:null}),s.reset(),s.clearErrors(),s.img_file=null,m.value="",p.value=!0)}function M(a){i("announcements.edit")&&(s.defaults({id:a.id,title:a.title,content:a.content||"",created_by:a.created_by||null}),s.reset(),s.clearErrors(),Object.assign(s,{id:a.id,title:a.title,content:a.content||"",created_by:a.created_by||null}),s.img_file=null,m.value=a.img_url||"",p.value=!0)}function T(){const a={preserveScroll:!0,forceFormData:!0,onSuccess:()=>{p.value=!1,window.location.reload()},onError:t=>{alert(t?.message||"Gagal menyimpan data.")}};if(s.id){if(!i("announcements.edit"))return;s.transform(t=>({...t,_method:"PUT"})).post(route("announcements.update",s.id),a)}else{if(!i("announcements.create"))return;s.post(route("announcements.store"),a)}}const g=f(null),x=f(!1),U=a=>{i("announcements.delete")&&(g.value=a,x.value=!0)},C=()=>{g.value=null,x.value=!1},$=()=>{i("announcements.delete")&&g.value?.id&&w.delete(route("announcements.destroy",g.value.id),{onSuccess:()=>{C()},onError:a=>{alert(a?.message||"Gagal menghapus data.")},preserveScroll:!0})};function P(a){return a?new Date(a).toLocaleString("id-ID"):"-"}function H(a,t=100){const l=(a||"").toString();return l.length>t?l.slice(0,t).trim()+"â€¦":l}function L(a){const t=a?.target?.files?.[0];t&&(s.img_file=t,m.value=URL.createObjectURL(t))}function O(){s.img_file=null,m.value=""}return(a,t)=>(o(),r("div",X,[y(n(I),{title:"Pengumuman"}),e("div",Z,[y(R,{items:[{label:"Pengumuman"}]}),e("div",ee,[n(i)("announcements.create")?(o(),r("button",{key:0,class:"px-3 py-2 text-sm text-white bg-blue-600 rounded hover:bg-blue-700",onClick:j}," Tambah Pengumuman ")):d("",!0)])]),e("div",te,[e("div",se,[t[6]||(t[6]=e("div",{class:"text-xl font-semibold text-gray-800"}," Daftar Pengumuman ",-1)),e("div",ne,[_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>b.value=l),type:"text",placeholder:"Cari...",class:"py-2.5 pr-8 pl-3 w-64 h-10 text-sm text-gray-800 bg-transparent rounded-lg border border-gray-200 focus:border-blue-300 focus:outline-hidden focus:ring-2 focus:ring-blue-500/20"},null,512),[[v,b.value]]),t[5]||(t[5]=e("span",{class:"absolute text-gray-400 -translate-y-1/2 right-2 top-1/2"},"ðŸ”",-1))])]),e("div",ae,[e("table",le,[e("thead",null,[e("tr",null,[t[8]||(t[8]=e("th",{class:"p-3 bg-gray-100 border-gray-200 border-y"},[e("div",{class:"font-medium text-center text-gray-600"}," No ")],-1)),t[9]||(t[9]=e("th",{class:"p-3 bg-gray-100 border border-gray-200"},[e("div",{class:"font-medium text-left text-gray-600"}," Judul ")],-1)),t[10]||(t[10]=e("th",{class:"p-3 bg-gray-100 border border-gray-200"},[e("div",{class:"font-medium text-left text-gray-600"}," Gambar ")],-1)),t[11]||(t[11]=e("th",{class:"p-3 bg-gray-100 border border-gray-200"},[e("div",{class:"font-medium text-left text-gray-600"}," Konten ")],-1)),t[12]||(t[12]=e("th",{class:"p-3 bg-gray-100 border-gray-200 border-y"},[e("div",{class:"font-medium text-center text-gray-600"}," Dibuat Oleh ")],-1)),t[13]||(t[13]=e("th",{class:"p-3 bg-gray-100 border-gray-200 border-y"},[e("div",{class:"font-medium text-center text-gray-600"}," Dibuat ")],-1)),n(i)("announcements.edit")||n(i)("announcements.delete")?(o(),r("th",oe,[...t[7]||(t[7]=[e("div",{class:"font-medium text-center text-gray-600"}," Aksi ",-1)])])):d("",!0)])]),e("tbody",null,[c.value.data&&c.value.data.length?(o(!0),r(A,{key:0},J(c.value.data,(l,V)=>(o(),r("tr",{key:l.id,class:"border-b border-gray-200"},[e("td",re,u((c.value.current_page-1)*c.value.per_page+V+1),1),e("td",ie,u(l.title),1),e("td",de,[l.img_url?(o(),r("img",{key:0,src:l.img_url,alt:"gambar",class:"h-10 rounded"},null,8,ue)):(o(),r("span",ce,"-"))]),e("td",me,u(H(l.content,120)),1),e("td",pe,u(l.user?.name||"-"),1),e("td",ge,u(P(l.created_at)),1),n(i)("announcements.edit")||n(i)("announcements.delete")?(o(),r("td",fe,[e("div",be,[n(i)("announcements.edit")?(o(),r("button",{key:0,class:"p-1 text-yellow-500 hover:text-yellow-700",onClick:q=>M(l),title:"Edit"}," Edit ",8,ye)):d("",!0),n(i)("announcements.delete")?(o(),r("button",{key:1,class:"p-1 text-red-500 hover:text-red-700",onClick:q=>U(l),title:"Hapus"}," Hapus ",8,xe)):d("",!0)])])):d("",!0)]))),128)):(o(),r("tr",_e,[e("td",{colspan:n(i)("announcements.edit")||n(i)("announcements.delete")?7:6,class:"py-6 text-center text-gray-500"}," Tidak ada data ",8,ve)]))])])]),c.value.data&&c.value.data.length?(o(),N(Y,{key:0,pagination:c.value,class:"border-t"},null,8,["pagination"])):d("",!0)]),y(n(W),{visible:p.value,"onUpdate:visible":t[4]||(t[4]=l=>p.value=l),modal:"",dismissableMask:"",style:{width:"520px",padding:"6px"}},{header:D(()=>[e("div",he,[e("h3",ke,u(n(s).id?"Edit":"Tambah")+" Pengumuman ",1)])]),default:D(()=>[e("div",Ce,[e("div",null,[t[14]||(t[14]=e("label",{class:"block mb-1 text-sm text-gray-600"},"Judul",-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>n(s).title=l),type:"text",class:"w-full h-10 px-3 border border-gray-300 rounded"},null,512),[[v,n(s).title]]),n(s).errors.title?(o(),r("p",we,u(n(s).errors.title),1)):d("",!0)]),e("div",null,[t[15]||(t[15]=e("label",{class:"block mb-1 text-sm text-gray-600"},"Konten",-1)),_(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>n(s).content=l),class:"w-full h-24 px-3 border border-gray-300 rounded",placeholder:"Masukkan konten pengumuman"},null,512),[[v,n(s).content]]),n(s).errors.content?(o(),r("p",De,u(n(s).errors.content),1)):d("",!0)]),e("div",null,[t[16]||(t[16]=e("label",{class:"block mb-1 text-sm text-gray-600"},"Gambar (opsional)",-1)),e("div",Se,[e("input",{type:"file",accept:"image/*",onChange:L,class:"w-full h-10 px-3 border border-gray-300 rounded"},null,32),m.value||n(s).img_url?(o(),r("button",{key:0,type:"button",class:"h-10 px-2 text-xs border rounded",onClick:O}," Hapus ")):d("",!0)]),n(s).errors.img_file?(o(),r("p",Ee,u(n(s).errors.img_file),1)):d("",!0),m.value||n(s).img_url?(o(),r("div",je,[e("img",{src:m.value||n(s).img_url,alt:"preview",class:"h-24 border rounded"},null,8,Me)])):d("",!0)]),e("div",Te,[e("button",{class:"h-10 px-3 border rounded",type:"button",onClick:t[3]||(t[3]=l=>p.value=!1)}," Batal "),e("button",{disabled:n(s).processing,class:"h-10 px-3 text-white bg-blue-600 rounded disabled:opacity-60",type:"button",onClick:T},[n(s).processing?(o(),r("span",$e,"Menyimpan...")):(o(),r("span",Pe,"Simpan"))],8,Ue)])])]),_:1},8,["visible"]),y(z,{show:x.value,question:"Yakin ingin menghapus",selected:`${g.value?.title||""}`,title:"Hapus Pengumuman",confirmText:"Ya, Hapus!",maxWidth:"md",onClose:C,onConfirm:$},null,8,["show","selected"])]))}});export{Re as default};
