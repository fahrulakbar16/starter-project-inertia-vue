import{I as M,y as x,d as c,e as o,o as l,a as e,c as _,f as v,F as h,i as k,t as a,K as j,n as D,T as C,L}from"./app-CJkCV51W.js";import{_ as B}from"./Pagination-C2dOEo8X.js";import{_ as $}from"./AvatarInitials-XMdLKKbn.js";const F={class:"overflow-auto","data-simplebar":""},H={class:"min-w-full text-sm"},N={class:"p-3 text-center"},P={class:"p-3"},S={class:"flex gap-3 items-center"},z=["src"],A={class:"flex flex-col"},E={class:"font-medium text-gray-800"},J={class:"text-xs text-gray-500"},K={class:"p-3"},R={class:"p-3"},V={class:"p-3"},G=["onClick"],I={key:1},O={class:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden"},U={class:"flex items-center justify-between p-6 border-b border-gray-200"},W={class:"mt-1 text-sm text-gray-500"},Y={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},q={key:0,class:"text-center py-8"},Q={key:1,class:"text-center py-8"},X={key:2,class:"space-y-4"},Z={class:"flex items-start justify-between"},ee={class:"flex-1"},te={class:"flex items-center gap-3 mb-2"},se={class:"text-sm font-medium text-gray-900"},ae={class:"grid grid-cols-2 gap-4 text-sm"},le={class:"ml-2 font-medium text-gray-900"},oe={class:"ml-2 font-medium text-gray-900"},re={class:"ml-2 font-medium text-gray-900"},ne={class:"ml-2 font-medium text-gray-900"},ie={class:"col-span-2"},de={class:"ml-2 font-semibold text-red-600"},ge={__name:"LateTab",props:{rows:{type:Object,default:null}},setup(i){const w=i;M();const d=x(()=>w.rows?.data??[]),f=x(()=>Array.isArray(d.value)&&d.value.length>0),u=c(!1),m=c(null),n=c([]),y=c(!1),b=x(()=>{const r=new URL(window.location.href);return{year:r.searchParams.get("year")||new Date().getFullYear(),month:r.searchParams.get("month")||new Date().getMonth()+1}}),T=async r=>{m.value=r,u.value=!0,y.value=!0,n.value=[];try{const t=await L.get(`/attendance-recap/late-details/${r.employee.id}`,{params:{year:b.value.year,month:b.value.month}});t.data.success&&(n.value=t.data.data)}catch(t){console.error("Error fetching late details:",t),alert("Gagal memuat detail keterlambatan")}finally{y.value=!1}},g=()=>{u.value=!1,m.value=null,n.value=[]};return(r,t)=>(l(),o("div",null,[e("div",F,[e("table",H,[t[1]||(t[1]=e("thead",null,[e("tr",null,[e("th",{class:"p-3 bg-gray-100 border-gray-200 border-y"},[e("div",{class:"font-medium text-center text-gray-600"}," No ")]),e("th",{class:"p-3 bg-gray-100 border border-gray-200"},[e("div",{class:"font-medium text-left text-gray-600"}," Nama & Jabatan Pekerja ")]),e("th",{class:"p-3 bg-gray-100 border border-gray-200"},[e("div",{class:"font-medium text-left text-gray-600"}," Total Hari Terlambat Dalam Toleransi ")]),e("th",{class:"p-3 bg-gray-100 border border-gray-200"},[e("div",{class:"font-medium text-left text-gray-600"}," Total Hari Terlambat Lewat Toleransi ")]),e("th",{class:"p-3 bg-gray-100 border-gray-200 border-y"},[e("div",{class:"font-medium text-left text-gray-600"}," Aksi ")])])],-1)),e("tbody",null,[f.value?(l(!0),o(h,{key:0},k(d.value,(s,p)=>(l(),o("tr",{key:s.id??p,class:"border-b border-gray-200"},[e("td",N,a(((i.rows?.current_page??1)-1)*(i.rows?.per_page??d.value.length)+p+1),1),e("td",P,[e("div",S,[s.employee.photo_url?(l(),o("img",{key:0,src:s.employee.photo_url?`/storage/${s.employee.photo_url}`:"",alt:"avatar",class:"object-cover w-8 h-8 rounded-full"},null,8,z)):(l(),_($,{key:1,name:s.employee.name,gender:s.employee.gender||"",size:32},null,8,["name","gender"])),e("div",A,[e("span",E,a(s.employee.name),1),e("span",J,a(s.employee.role||"Staff"),1)])])]),e("td",K,a(s.late_within_tolerance_days??0)+" Hari ("+a(s.late_within_tolerance_minutes??0)+" Menit) ",1),e("td",R,a(s.late_exceed_tolerance_days??0)+" Hari ("+a(s.late_exceed_tolerance_minutes??0)+" Menit) ",1),e("td",V,[e("button",{onClick:ce=>T(s),class:"text-blue-600 hover:underline"}," Lihat Detail ",8,G)])]))),128)):(l(),o("tr",I,[...t[0]||(t[0]=[e("td",{colspan:"5",class:"py-6 text-center text-gray-500"}," Tidak ada data ",-1)])]))])])]),f.value?(l(),_(B,{key:0,pagination:i.rows,class:"border-t"},null,8,["pagination"])):v("",!0),(l(),_(C,{to:"body"},[u.value?(l(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:j(g,["self"])},[e("div",O,[e("div",U,[e("div",null,[t[2]||(t[2]=e("h3",{class:"text-xl font-semibold text-gray-900"}," Detail Keterlambatan ",-1)),e("p",W,a(m.value?.employee?.name),1)]),e("button",{onClick:g,class:"text-gray-400 hover:text-gray-600"},[...t[3]||(t[3]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Y,[y.value?(l(),o("div",q,[...t[4]||(t[4]=[e("div",{class:"inline-block w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"mt-2 text-gray-500"},"Memuat data...",-1)])])):n.value.length===0?(l(),o("div",Q,[...t[5]||(t[5]=[e("p",{class:"text-gray-500"},"Tidak ada data keterlambatan",-1)])])):(l(),o("div",X,[(l(!0),o(h,null,k(n.value,(s,p)=>(l(),o("div",{key:s.id,class:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50"},[e("div",Z,[e("div",ee,[e("div",te,[e("span",{class:D(["inline-flex items-center px-2 py-1 text-xs font-medium rounded-full",s.status==="within_tolerance"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},a(s.status_label),3),e("span",se,a(s.date_formatted),1)]),e("div",ae,[e("div",null,[t[6]||(t[6]=e("span",{class:"text-gray-500"},"Shift:",-1)),e("span",le,a(s.shift_name),1)]),e("div",null,[t[7]||(t[7]=e("span",{class:"text-gray-500"},"Waktu Shift:",-1)),e("span",oe,a(s.shift_start),1)]),e("div",null,[t[8]||(t[8]=e("span",{class:"text-gray-500"},"Jam Masuk:",-1)),e("span",re,a(s.jam_masuk),1)]),e("div",null,[t[9]||(t[9]=e("span",{class:"text-gray-500"},"Batas Toleransi:",-1)),e("span",ne,a(s.late_tolerance),1)]),e("div",ie,[t[10]||(t[10]=e("span",{class:"text-gray-500"},"Durasi Terlambat:",-1)),e("span",de,a(s.late_minutes)+" menit ",1)])])])])]))),128))]))]),e("div",{class:"flex justify-end p-6 border-t border-gray-200"},[e("button",{onClick:g,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Tutup ")])])])):v("",!0)]))]))}};export{ge as default};
