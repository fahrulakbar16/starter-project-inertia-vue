import{d as v,y as C,z as P,U as oe,e as p,o as i,b as l,a as e,g as k,D as le,c as T,f as b,w as _,P as q,E as w,J as H,h as V,G as I,S as ne,F as B,i as G,t as d,n as z,H as M}from"./app-CJkCV51W.js";import{_ as de}from"./AppLayout-BlEKf3Fz.js";import{_ as ie}from"./Breadcrumb-BJQpsGcc.js";import{_ as ue}from"./Pagination-C2dOEo8X.js";import{P as pe}from"./PlusSquareIcon-DA_kLpvy.js";import{_ as ge}from"./ConfirmModal-DAlWp-FQ.js";import{S as Y}from"./ShowIcon-CiA5nZAB.js";import{_ as J}from"./SelectPemakaian-bo5sz744.js";import{E as K}from"./EditIcon-B9T5EQzJ.js";import{T as W}from"./TrashIcon-DSAHmBPH.js";import"./FlashMessage-D4C-FUm8.js";import"./LayoutShell-FWpWJLvi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-DvuTgkfF.js";import"./LayoutShell.vue_vue_type_style_index_0_lang-CRqqKi3W.js";const ye={class:"flex overflow-hidden flex-col gap-3 px-3 h-full"},ce={class:"flex justify-between items-center h-10"},me={class:"flex flex-col overflow-hidden rounded-lg border border-gray-200 bg-white dark:border-gray-600 dark:bg-white/[0.03]"},be={class:"flex flex-col gap-2 px-8 h-16 sm:flex-row sm:items-center sm:justify-between"},fe={class:"flex gap-3 items-center"},xe={class:"overflow-auto overflow-x-auto","data-simplebar":""},ve={class:"min-w-full text-sm table-fixed"},ke={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},he={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},_e={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},qe={class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},we={colspan:"2",class:"p-2 bg-gray-50 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-900"},Be={class:"relative space-x-4"},De={class:"px-2 py-2 bg-gray-50 border border-gray-200 dark:border-gray-600 dark:bg-gray-900"},Se={class:"px-2 py-2 bg-gray-50 border border-gray-200 dark:border-gray-600 dark:bg-gray-900"},Ce={class:"px-2 py-2 bg-gray-50 border border-gray-200 dark:border-gray-600 dark:bg-gray-900"},Pe={class:"grid grid-cols-2 gap-2 w-72"},Ve={class:"px-2 py-2 bg-gray-50 border border-gray-200 dark:border-gray-600 dark:bg-gray-900"},$e={key:0},je={key:0},Re={colspan:7,class:"px-4 py-2 font-semibold text-left text-gray-600 bg-gray-50 dark:bg-gray-900/40 dark:text-gray-300"},Te=["onClick"],Ie={class:"text-xs"},Ge={class:"ml-1 text-xs font-medium text-gray-500"},Me={class:"px-3 py-3 text-center"},Ue={class:"px-3 py-3 font-mono"},Ne={class:"px-3 py-3"},Ee={class:"px-3 py-3"},Le={class:"px-3 py-3 text-center"},Oe={class:"px-3 py-3"},Fe={class:"px-6 py-3"},Ae={class:"flex gap-2 items-center"},He=["onClick"],ze={class:"px-3 py-3 text-center"},Ye={class:"px-3 py-3 font-mono"},Je={class:"px-3 py-3"},Ke={class:"px-3 py-3 w-72"},We={class:"px-3 py-3 text-center"},Qe={class:"px-3 py-3 text-center"},Xe={class:"px-6 py-3"},Ze={class:"flex gap-2 justify-between items-center"},et=["onClick"],tt={components:{SortIcon:{props:{active:Boolean,direction:String},template:`
                <span class="inline-block ml-2 text-xs">
                    <template v-if="active">
                        {{ direction === 'asc' ? 'â–²' : 'â–¼' }}
                    </template>
                    <template v-else>
                        â‡…
                    </template>
                </span>
            `}}},xt=Object.assign(tt,{layout:de},{__name:"Index",props:{materialRequests:{type:Object,required:!0},departments:{type:Array,required:!0},employees:{type:Array,required:!0},filters:{type:Object,default:()=>({})},sortBy:{type:String,default:"requested_at"},sortDirection:{type:String,default:"desc"},groupBy:{type:String,default:"all"},can_approve:{type:Boolean,default:!1},can_edit:{type:Boolean,default:!1},can_delete:{type:Boolean,default:!1},can_view:{type:Boolean,default:!1},can_create:{type:Boolean,default:!1}},setup(n){const Q=[{label:"Penyimpanan"},{label:"Permintaan Barang"}],o=n,s=v({q:o.filters.q??"",employee_id:o.filters.employee_id??null,department_id:o.filters.department_id??null,date_from:o.filters.date_from??"",date_to:o.filters.date_to??"",status:o.filters.status??""}),c=v(""),$=v(!1),h=v(null),f=v(o.groupBy??"all"),x=C(()=>f.value||(o.groupBy??"")),D=C(()=>!!x.value),U=C(()=>{const a={},t=((o.materialRequests.current_page||1)-1)*(o.materialRequests.per_page||20);return(o.materialRequests.data||[]).forEach((r,y)=>{a[r.id]=t+y+1}),a}),j=v(new Set),X=C(()=>{if(!D.value)return{};c.value===null&&(D.value=!1,console.log("groupBy",c.value)),console.log("groupedData",D.value);const a=o.materialRequests.data||[],t={};for(const g of a){const r=Z(g);t[r]||(t[r]=[]),t[r].push(g)}return t});function Z(a){switch(x.value){case"department":return a.department??"Tanpa Departemen";case"requested_by":return a.requested_by??"Tanpa Pemohon";case"status":return R(a.status)}}function ee(a){switch(x.value){case"department":return`Departemen: ${a}`;case"requested_by":return`Diminta oleh: ${a}`;case"status":return`Status: ${a}`;default:return a}}function N(a){return j.value.has(a)}function te(a){const t=new Set(j.value);t.has(a)?t.delete(a):t.add(a),j.value=t}function m({sortBy:a=o.sortBy,sortDirection:t=o.sortDirection}={}){c.value=x.value,c.value==="all"&&(c.value=null),console.log("groupBy",c.value),M.get(route("material-requests.index"),{...s.value,groupBy:c.value||null,sortBy:a,sortDirection:t},{preserveScroll:!0,preserveState:!0,replace:!0,onStart:()=>{typeof window<"u"&&(window.__suppressProgress=!0)},onFinish:()=>{typeof window<"u"&&(window.__suppressProgress=!1)}})}let E;P(()=>s.value.q,()=>{clearTimeout(E),E=setTimeout(()=>m({}),400)}),P(()=>[s.value.department_id,s.value.employee_id,s.value.status,s.value.date_from,s.value.date_to],()=>{m({})}),P(f,()=>{L(),m({})}),P(()=>o.groupBy,a=>{!f.value&&a&&(f.value=a)});function S(a){const t=o.sortBy===a&&o.sortDirection==="asc"?"desc":"asc";m({sortBy:a,sortDirection:t})}function L(){s.value={q:"",employee_id:null,department_id:null,date_from:"",date_to:"",status:""},m({})}function R(a){return{pending:"Menunggu Persetujuan",approved:"Disetujui",rejected:"Ditolak",canceled:"Dibatalkan",partial_approved:"Disetujui Sebagian"}[a]??a}function O(a){return{pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-500/20 dark:text-yellow-300",approved:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300",rejected:"bg-rose-100 text-rose-800 dark:bg-rose-500/20 dark:text-rose-300",canceled:"bg-slate-100 text-slate-700 dark:bg-slate-500/20 dark:text-slate-300",partial_approved:"bg-violet-100 text-violet-800 dark:bg-violet-500/20 dark:text-violet-300"}[a]??"bg-gray-100 text-gray-700"}function F(a){a?.id&&(h.value=a,$.value=!0)}function A(){$.value=!1,h.value=null}function ae(){h.value?.id&&M.delete(route("material-requests.destroy",h.value.id),{preserveScroll:!0,onSuccess:()=>{A(),m({})}})}function re(a){m({})}function se(a){M.get(route("material-requests.index"),{...s.value,groupBy:x.value||null,sortBy:o.sortBy,sortDirection:o.sortDirection,per_page:a},{preserveScroll:!0,preserveState:!0,replace:!0})}return(a,t)=>{const g=oe("SortIcon");return i(),p(B,null,[l(k(le),{title:"Permintaan Barang"}),e("div",ye,[e("div",ce,[l(ie,{items:Q}),n.can_create?(i(),T(k(q),{key:0,href:a.route("material-requests.create"),class:"inline-flex items-center gap-2 text-white hover:text-blue-500 rounded-md border hover:border-gray-300 bg-blue-500 px-3 py-2 text-sm font-medium text-white-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] dark:hover:text-gray-200"},{default:_(()=>[l(pe),t[11]||(t[11]=e("span",{class:"hidden md:block"},"Buat Permintaan",-1))]),_:1},8,["href"])):b("",!0)]),e("div",me,[e("div",be,[t[13]||(t[13]=e("div",{class:"font-bold text-gray-700 md:text-xl dark:text-gray-300"}," Daftar Permintaan Barang ",-1)),e("div",fe,[e("div",null,[w(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>f.value=r),class:"px-3 h-10 text-sm text-gray-800 bg-transparent rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},[...t[12]||(t[12]=[e("option",{value:"all"},"Kelompokan Berdasarkan",-1),e("option",{value:"department"}," Group: Departemen ",-1),e("option",{value:"requested_by"}," Group: Diminta oleh ",-1),e("option",{value:"status"},"Group: Status",-1)])],512),[[H,f.value]])])])]),e("div",xe,[e("table",ve,[t[24]||(t[24]=e("colgroup",null,[e("col",{style:{width:"30px"}}),e("col",{style:{width:"160px"}}),e("col",{style:{width:"200px"}}),e("col",{style:{width:"220px"}}),e("col",{style:{width:"160px"}}),e("col",{style:{width:"140px"}}),e("col",{style:{width:"140px"}})],-1)),e("thead",null,[e("tr",null,[t[18]||(t[18]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," No. ")],-1)),t[19]||(t[19]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," No. Request ")],-1)),e("th",ke,[e("button",{onClick:t[1]||(t[1]=r=>S("requested_by")),class:"px-3 w-full font-medium text-left text-gray-600 whitespace-nowrap dark:text-gray-300"},[t[14]||(t[14]=V(" Permintaan oleh ",-1)),l(g,{active:n.sortBy==="requested_by",direction:n.sortDirection},null,8,["active","direction"])])]),e("th",he,[e("button",{onClick:t[2]||(t[2]=r=>S("department")),class:"px-3 w-full font-medium text-left text-gray-600 whitespace-nowrap dark:text-gray-300"},[t[15]||(t[15]=V(" Departemen ",-1)),l(g,{active:n.sortBy==="department",direction:n.sortDirection},null,8,["active","direction"])])]),e("th",_e,[e("button",{onClick:t[3]||(t[3]=r=>S("requested_at")),class:"px-3 w-full font-medium text-left text-gray-600 dark:text-gray-300"},[t[16]||(t[16]=V(" Tanggal Permintaan ",-1)),l(g,{active:n.sortBy==="requested_at",direction:n.sortDirection},null,8,["active","direction"])])]),e("th",qe,[e("button",{onClick:t[4]||(t[4]=r=>S("status")),class:"px-3 w-full font-medium text-left text-gray-600 dark:text-gray-300"},[t[17]||(t[17]=V(" Status ",-1)),l(g,{active:n.sortBy==="status",direction:n.sortDirection},null,8,["active","direction"])])]),t[20]||(t[20]=e("th",{class:"py-2.5 bg-gray-100 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-800"},[e("div",{class:"px-3 font-medium text-gray-600 dark:text-gray-300"}," Aksi ")],-1))]),e("tr",null,[e("th",we,[e("div",Be,[w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>s.value.q=r),type:"text",placeholder:"Cari nomor request / nama pemohon",class:"py-2.5 pr-12 pl-4 text-sm text-gray-800 bg-transparent rounded-lg border border-gray-200 focus:border-blue-300 focus:outline-hidden focus:ring-2 focus:ring-blue-500/20"},null,512),[[I,s.value.q]]),t[21]||(t[21]=e("span",{class:"absolute right-4 top-1/2 text-gray-400 -translate-y-1/2"},"ðŸ”",-1))])]),e("th",De,[l(J,{modelValue:s.value.employee_id,"onUpdate:modelValue":t[6]||(t[6]=r=>s.value.employee_id=r),items:[{id:null,name:"Semua"},...n.employees],label:"Pilih Pemohon",class:"w-full text-xs sm:text-sm"},null,8,["modelValue","items"])]),e("th",Se,[l(J,{modelValue:s.value.department_id,"onUpdate:modelValue":t[7]||(t[7]=r=>s.value.department_id=r),items:[{id:null,name:"Semua"},...n.departments],label:"Pilih Departemen",class:"w-full text-xs sm:text-sm"},null,8,["modelValue","items"])]),e("th",Ce,[e("div",Pe,[w(e("input",{"onUpdate:modelValue":t[8]||(t[8]=r=>s.value.date_from=r),type:"date",class:"px-2 w-full h-10 text-xs rounded border-gray-300 sm:text-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},null,512),[[I,s.value.date_from]]),w(e("input",{"onUpdate:modelValue":t[9]||(t[9]=r=>s.value.date_to=r),type:"date",class:"px-2 w-full h-10 text-xs rounded border-gray-300 sm:text-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},null,512),[[I,s.value.date_to]])])]),e("th",Ve,[w(e("select",{"onUpdate:modelValue":t[10]||(t[10]=r=>s.value.status=r),class:"px-3 h-10 text-xs rounded border-gray-300 w-54 sm:text-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white/90"},[...t[22]||(t[22]=[ne('<option value="">Semua</option><option value="pending"> Menunggu Persetujuan </option><option value="approved">Disetujui</option><option value="rejected">Ditolak</option><option value="canceled">Dibatalkan</option><option value="partial_approved"> Disetujui Sebagian </option>',6)])],512),[[H,s.value.status]])]),e("th",{class:"px-2 py-2 bg-gray-50 border-gray-200 border-y dark:border-gray-600 dark:bg-gray-900"},[e("button",{onClick:L,class:"px-3 py-2 text-xs text-white bg-red-500 rounded hover:bg-red-600"}," Clear ")])])]),e("tbody",null,[!n.materialRequests.data||n.materialRequests.data.length===0?(i(),p("tr",$e,[...t[23]||(t[23]=[e("td",{colspan:"7",class:"py-8 text-center text-gray-500"}," Tidak ada data ",-1)])])):b("",!0),D.value?(i(!0),p(B,{key:1},G(X.value,(r,y)=>(i(),p(B,{key:y},[x.value!=="all"?(i(),p("tr",je,[e("td",Re,[e("button",{class:"inline-flex gap-2 items-center",onClick:u=>te(y)},[e("span",Ie,d(N(y)?"â–¶":"â–¼"),1),e("span",null,d(ee(y)),1),e("span",Ge,"("+d(r.length)+")",1)],8,Te)])])):b("",!0),N(y)?b("",!0):(i(!0),p(B,{key:1},G(r,u=>(i(),p("tr",{key:u.id,class:"border-b border-gray-200 dark:border-gray-700"},[e("td",Me,d(U.value[u.id]??"-")+". ",1),e("td",Ue,d(u.request_no),1),e("td",Ne,d(u.requested_by),1),e("td",Ee,d(u.department),1),e("td",Le,d(u.requested_at),1),e("td",Oe,[e("span",{class:z([O(u.status),"px-2.5 py-1 text-xs font-medium rounded-full"])},d(R(u.status)),3)]),e("td",Fe,[e("div",Ae,[l(k(q),{href:a.route("material-requests.show",u.id)},{default:_(()=>[l(Y,{class:"text-blue-400"})]),_:1},8,["href"]),n.can_edit?(i(),T(k(q),{key:0,href:a.route("material-requests.edit",u.id)},{default:_(()=>[l(K,{class:"text-yellow-500"})]),_:1},8,["href"])):b("",!0),n.can_delete?(i(),p("button",{key:1,type:"button",onClick:at=>F(u)},[l(W,{class:"text-red-500"})],8,He)):b("",!0)])])]))),128))],64))),128)):(i(!0),p(B,{key:2},G(n.materialRequests.data,r=>(i(),p("tr",{key:r.id,class:"border-b border-gray-200 dark:border-gray-700"},[e("td",ze,d(U.value[r.id]??"-")+". ",1),e("td",Ye,d(r.request_no),1),e("td",Je,d(r.requested_by),1),e("td",Ke,d(r.department),1),e("td",We,d(r.requested_at),1),e("td",Qe,[e("span",{class:z([O(r.status),"px-2.5 py-1 text-xs font-medium rounded-full"])},d(R(r.status)),3)]),e("td",Xe,[e("div",Ze,[l(k(q),{href:a.route("material-requests.show",r.id)},{default:_(()=>[l(Y,{class:"text-blue-400"})]),_:1},8,["href"]),r.status==="pending"?(i(),T(k(q),{key:0,href:a.route("material-requests.edit",r.id)},{default:_(()=>[l(K,{class:"text-yellow-500"})]),_:1},8,["href"])):b("",!0),e("button",{type:"button",onClick:y=>F(r)},[l(W,{class:"text-red-500"})],8,et)])])]))),128))])]),l(ue,{pagination:n.materialRequests,onPageChange:re,onPerPageChange:se,class:"border-t"},null,8,["pagination"])])])]),l(ge,{show:$.value,question:"Yakin ingin menghapus material request",selected:`${h.value?.request_no||"ini"}`,title:"Hapus Material Request",confirmText:"Ya, Hapus!",maxWidth:"md",onClose:A,onConfirm:ae},null,8,["show","selected"])],64)}}});export{xt as default};
