import{d as g,y as f,l as F,s as J,e as m,o as u,a,c as j,t as h,E,V as q,bt as H,K,G as P,f as B,F as W,i as G,r as R,O as Q,T as X,p as Y}from"./app-CJkCV51W.js";const Z=["disabled"],ee={class:"truncate"},te={class:"p-2"},le=["onKeydown"],oe={class:"max-h-24 overflow-y-auto","data-simplebar":""},ae=["checked"],ne={class:"font-medium text-gray-700"},re=["onClick"],se=["checked"],ie={key:1,class:"px-4 py-2 text-gray-500 italic"},ue={__name:"Select",props:{items:{type:Array,default:()=>[]},modelValue:{type:[String,Number,null],default:null},label:{type:String,default:"Pilih Item"},taggable:{type:Boolean,default:!1},labelKey:{type:String,default:"name"},searchKey:{type:String,default:"name"},disabled:{type:Boolean,default:!1},persistKey:{type:String,default:null}},emits:["update:modelValue"],setup(s,{emit:I}){const C=`select-btn-${Math.random().toString(36).substr(2,9)}`,e=s,b=I,c=g(!1),r=g(""),k=g(null),x=g({}),n=g([]),V=f(()=>{const t=e.items.find(l=>l.id===e.modelValue)||n.value.find(l=>l.id===e.modelValue);if(t)return t;if(typeof e.modelValue=="string"&&e.modelValue){const l=e.modelValue.toString().toLowerCase();return e.items.find(o=>(o[e.labelKey]||"").toString().toLowerCase()===l)||n.value.find(o=>(o[e.labelKey]||"").toString().toLowerCase()===l)||null}return null}),T=f(()=>V.value?V.value[e.labelKey]:typeof e.modelValue=="string"&&e.modelValue?e.modelValue:e.label);function D(t){return e.labelKey&&t[e.labelKey]?t.type?.name?`${t[e.labelKey]} - ${t.type.name}`:t[e.labelKey]:t.name||""}const L=f(()=>{const t=(r.value||"").toLowerCase(),l=new Map,o=d=>{d.forEach(y=>{const w=(y[e.labelKey]||"").toString().toLowerCase();l.has(w)||l.set(w,y)})};return o(n.value),o(e.items||[]),Array.from(l.values()).filter(d=>{const y=(d[e.searchKey]||"").toString().toLowerCase(),w=D(d).toLowerCase();return y.includes(t)||w.includes(t)})});function M(){c.value=!c.value,c.value&&Y(()=>{p()})}function p(){const t=document.getElementById(C);if(!t)return;const l=t.getBoundingClientRect(),o=200,i=window.innerHeight-l.bottom,d=l.top;i<o&&d>i?x.value={top:`${l.top-o}px`,left:`${l.left}px`,width:`${l.width}px`}:x.value={top:`${l.bottom+8}px`,left:`${l.left}px`,width:`${l.width}px`}}function v(){c.value=!1}function N(t){e.modelValue,b("update:modelValue",t.id),v()}function O(){b("update:modelValue",null),v()}function U(t){return e.modelValue===t.id||typeof e.modelValue=="string"&&(t[e.labelKey]||"")===e.modelValue}function _(t){k.value&&!k.value.contains(t.target)&&v()}F(()=>{if(document.addEventListener("click",_),window.addEventListener("scroll",p,!0),window.addEventListener("resize",p),e.persistKey)try{const t=localStorage.getItem(`select_local_${e.persistKey}`);t&&(n.value=JSON.parse(t))}catch{}}),J(()=>{if(document.removeEventListener("click",_),window.removeEventListener("scroll",p,!0),window.removeEventListener("resize",p),e.persistKey)try{localStorage.setItem(`select_local_${e.persistKey}`,JSON.stringify(n.value))}catch{}});const z=f(()=>e.items.some(t=>(t[e.searchKey]||"").toString().toLowerCase()===(r.value||"").toLowerCase())),S=f(()=>e.taggable&&!!r.value&&!z.value);function $(){if(!S.value)return;const t=(r.value||"").toString(),l=o=>o.some(i=>(i[e.labelKey]||"").toString().toLowerCase()===t.toLowerCase());if(!l(n.value)&&!l(e.items||[])){console.log(n.value);const o={id:`${t}`,[e.labelKey]:t};if(n.value.unshift(o),e.persistKey)try{localStorage.setItem(`select_local_${e.persistKey}`,JSON.stringify(n.value))}catch{}}b("update:modelValue",t),v()}function A(){S.value&&$()}return(t,l)=>(u(),m("div",{class:"relative",ref_key:"dropdownWrapper",ref:k},[a("button",{id:C,onClick:M,disabled:e.disabled,type:"button",class:"w-full rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 bg-white dark:bg-gray-700 dark:text-white dark:border-gray-600 flex justify-between items-center"},[a("span",ee,h(T.value),1),l[3]||(l[3]=a("svg",{class:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))],8,Z),(u(),j(X,{to:"body"},[E(a("div",{style:Q(x.value),class:"fixed mt-2 bg-white border border-gray-200 rounded-lg shadow-lg dark:bg-gray-700 dark:border-gray-600 z-[9999]"},[a("div",te,[E(a("input",{"onUpdate:modelValue":l[0]||(l[0]=o=>r.value=o),type:"text",placeholder:"Cari...",onKeydown:H(K(A,["prevent"]),["enter"]),class:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-sky-500 dark:bg-gray-600 dark:text-white"},null,40,le),[[P,r.value]])]),a("ul",oe,[a("li",{class:"px-4 py-2 cursor-pointer flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-600 border-b border-gray-200",onClick:O},[a("input",{type:"radio",class:"text-blue-600",checked:!s.modelValue||s.modelValue===null,onChange:l[1]||(l[1]=K(()=>{},["stop"]))},null,40,ae),a("span",ne,h(s.label),1)]),s.taggable&&S.value?(u(),m("li",{key:0,class:"px-4 py-2 cursor-pointer flex items-center gap-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-600",onClick:$},' Tambah: "'+h(r.value)+'" ',1)):B("",!0),(u(!0),m(W,null,G(L.value,o=>(u(),m("li",{key:o.id,class:"px-4 py-2 cursor-pointer flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-600",onClick:i=>N(o)},[a("input",{type:"radio",class:"text-blue-600",checked:U(o),onChange:l[2]||(l[2]=K(()=>{},["stop"]))},null,40,se),R(t.$slots,"item",{item:o},()=>[a("span",null,h(o.name),1)])],8,re))),128)),!s.taggable&&L.value.length===0?(u(),m("li",ie," Tidak ada hasil ")):B("",!0)])],4),[[q,c.value]])]))],512))}};export{ue as _};
